

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>22. 萨缪尔森乘数-加速器模型 &#8212; Python中级数量经济学</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d9faaf6c4b57726f74ba012412af1f5681bdff87"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'samuelson';</script>
    <link rel="canonical" href="https://python.quantecon-zh-cn.org/samuelson.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="23. Kesten过程与企业动态" href="kesten_processes.html" />
    <link rel="prev" title="21. 线性状态空间模型" href="linear_models.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。 />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="萨缪尔森乘数-加速器模型"/>
<meta name="twitter:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="萨缪尔森乘数-加速器模型" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon-zh-cn.org/samuelson.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。" />
<meta property="og:site_name" content="Python中级数量经济学" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=samuelson>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">22.1. 概述</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">22.1.1. 萨缪尔森模型</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">22.2. 详细内容</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">22.2.1. 模型的随机版本</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">22.2.2. 模型的数学分析</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">22.2.3. 本讲内容</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">22.3. 实现</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">22.3.1. 描述特征多项式含义的函数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">22.3.2. 绘制路径的函数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">22.3.3. 手动或”人工”求根计算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">22.3.4. 反向工程参数以生成阻尼周期</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy">22.3.5. 使用Numpy求根</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">22.3.6. 反向工程复数根：示例</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sympy">22.3.7. 题外话：使用 Sympy 求根</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">22.4. 随机冲击</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">22.5. 政府支出</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">22.6. 将所有内容封装到类中</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#samuelson">22.6.1. Samuelson类的说明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">22.6.2. 使用图形</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linearstatespace">22.7. 使用LinearStateSpace类</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">22.7.1. <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 类中的其他方法</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">22.7.2. 从 <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 继承方法</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">22.7.3. 图示</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">22.8. 纯乘数模型</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">22.9. 总结</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Python中级数量经济学</a></p>

                        <p class="qe-page__header-subheading">萨缪尔森乘数-加速器模型</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>托马斯·萨金特（Thomas J. Sargent）</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>约翰·斯塔胡斯基（John Stachurski）</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><a class="toc-backref" href="#id30"><span class="section-number">22. </span>萨缪尔森乘数-加速器模型</a><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="id2">
<p class="topic-title">目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id30">萨缪尔森乘数-加速器模型</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id31">概述</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id32">详细内容</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id33">实现</a></p></li>
<li><p><a class="reference internal" href="#id20" id="id34">随机冲击</a></p></li>
<li><p><a class="reference internal" href="#id21" id="id35">政府支出</a></p></li>
<li><p><a class="reference internal" href="#id22" id="id36">将所有内容封装到类中</a></p></li>
<li><p><a class="reference internal" href="#linearstatespace" id="id37">使用LinearStateSpace类</a></p></li>
<li><p><a class="reference internal" href="#id27" id="id38">纯乘数模型</a></p></li>
<li><p><a class="reference internal" href="#id28" id="id39">总结</a></p></li>
</ul>
</li>
</ul>
</div>
<p>除了Anaconda中已有的库外，本讲座还需要以下库：</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>quantecon
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (0.8.0)
Requirement already satisfied: numba&gt;=0.49.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (0.60.0)
Requirement already satisfied: numpy&gt;=1.17.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.26.4)
Requirement already satisfied: requests in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (2.32.3)
Requirement already satisfied: scipy&gt;=1.5.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.13.1)
Requirement already satisfied: sympy in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.14.0)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.43.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2024.8.30)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
</div>
</details>
</div>
<section id="id3">
<h2><a class="toc-backref" href="#id31"><span class="section-number">22.1. </span>概述</a><a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>本讲将创建保罗·萨缪尔森著名的乘数加速模型的非随机和随机版本 <span id="id4">[<a class="reference internal" href="zreferences.html#id88" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>。</p>
<p>在此过程中，我们将扩展<a class="reference external" href="https://python-programming.quantecon.org/python_oop.html">面向对象编程第二讲</a>中的索洛模型类示例。</p>
<p>我们的目标是：</p>
<ul class="simple">
<li><p>提供面向对象编程和类的更详细示例</p></li>
<li><p>回顾一个著名模型</p></li>
<li><p>回顾线性差分方程，包括确定性和随机性两种</p></li>
</ul>
<p>让我们从一些标准导入开始：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">FONTPATH</span> <span class="o">=</span> <span class="s2">&quot;fonts/SourceHanSerifSC-SemiBold.otf&quot;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">addfont</span><span class="p">(</span><span class="n">FONTPATH</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Source Han Serif SC&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1">#设置默认图形大小</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>我们还将使用以下内容来完成下面描述的各种任务：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quantecon</span> <span class="kn">import</span> <span class="n">LinearStateSpace</span>
<span class="kn">import</span> <span class="nn">cmath</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">init_printing</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">sqrt</span>
</pre></div>
</div>
</div>
</div>
<section id="id5">
<h3><span class="section-number">22.1.1. </span>萨缪尔森模型<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>萨缪尔森使用<em>二阶线性差分方程</em>来表示一个基于三个组成部分的国民产出模型：</p>
<ul class="simple">
<li><p><em>国民产出恒等式</em>，表明国民产出或国民收入是消费、投资和政府购买的总和。</p></li>
<li><p>凯恩斯式<em>消费函数</em>，表明t时期的消费等于一个常数乘以t-1时期的国民产出。</p></li>
<li><p>投资<em>加速器</em>，表明t时期的投资等于一个称为<em>加速系数</em>的常数乘以t-1时期和t-2时期产出之差。</p></li>
</ul>
<p>消费加投资加政府购买构成了<em>总需求</em>，这自动引致相等数量的<em>总供给</em>。</p>
<p>（关于线性差分方程的内容请参见<a class="reference external" href="https://en.wikipedia.org/wiki/Linear_difference_equation">这里</a>或<span id="id6">[<a class="reference internal" href="zreferences.html#id210" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>的第九章。）</p>
<p>Samuelson使用该模型分析了边际消费倾向和加速系数的特定值如何可能导致国民产出出现暂时性的<em>商业周期</em>。</p>
<p>可能的动态特性包括：</p>
<ul class="simple">
<li><p>平稳收敛到一个固定的产出水平</p></li>
<li><p>最终收敛到固定产出水平的衰减商业周期</p></li>
<li><p>既不衰减也不发散的持续性商业周期</p></li>
</ul>
<p>后面我们将介绍一个扩展模型，在国民收入恒等式右侧加入一个随机冲击项，代表总需求的随机波动。</p>
<p>这一修改使国民产出受到二阶<em>随机线性差分方程</em>的支配，在适当的参数值下，会产生反复出现的不规则商业周期。</p>
<p>(关于随机线性差分方程的内容，请参见<span id="id7">[<a class="reference internal" href="zreferences.html#id210" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>的第XI章。)</p>
</section>
</section>
<section id="id8">
<h2><a class="toc-backref" href="#id32"><span class="section-number">22.2. </span>详细内容</a><a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h2>
<p>让我们假设：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{G_t\}\)</span>是一系列的政府支出水平 –</p></li>
</ul>
<p>我们先将所有时期的 <span class="math notranslate nohighlight">\(G_t = G\)</span> 设为常数。</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{C_t\}\)</span> 是总消费支出水平的序列，是模型中的一个关键内生变量。</p></li>
<li><p><span class="math notranslate nohighlight">\(\{I_t\}\)</span> 是投资率的序列，是另一个关键内生变量。</p></li>
<li><p><span class="math notranslate nohighlight">\(\{Y_t\}\)</span> 是国民收入水平的序列，也是一个内生变量。</p></li>
</ul>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span> 是凯恩斯消费函数 <span class="math notranslate nohighlight">\(C_t = a Y_{t-1} + \gamma\)</span> 中的边际消费倾向。</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> 是”投资加速器”<span class="math notranslate nohighlight">\(I_t = b (Y_{t-1} - Y_{t-2})\)</span> 中的”加速系数”。</p></li>
<li><p><span class="math notranslate nohighlight">\(\{\epsilon_{t}\}\)</span> 是一个独立同分布的标准正态随机变量序列。</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma \geq 0\)</span> 是一个”波动性”参数 — 当设定 <span class="math notranslate nohighlight">\(\sigma = 0\)</span> 时，
我们将得到最初要研究的非随机情况。</p></li>
</ul>
<p>该模型结合了消费函数</p>
<div class="math notranslate nohighlight" id="equation-consumption">
<span class="eqno">(22.1)<a class="headerlink" href="#equation-consumption" title="Permalink to this equation">#</a></span>\[C_t = a Y_{t-1} + \gamma\]</div>
<p>和投资加速器</p>
<div class="math notranslate nohighlight" id="equation-accelerator">
<span class="eqno">(22.2)<a class="headerlink" href="#equation-accelerator" title="Permalink to this equation">#</a></span>\[I_t = b (Y_{t-1} - Y_{t-2})\]</div>
<p>以及国民收入恒等式</p>
<div class="math notranslate nohighlight" id="equation-income-identity">
<span class="eqno">(22.3)<a class="headerlink" href="#equation-income-identity" title="Permalink to this equation">#</a></span>\[Y_t = C_t + I_t + G_t\]</div>
<ul class="simple">
<li><p>参数 <span class="math notranslate nohighlight">\(a\)</span> 是人们的收入<em>边际消费倾向</em></p>
<ul>
<li><p>方程 <a class="reference internal" href="#equation-consumption">(22.1)</a> 表明人们会消费每增加一美元收入中的 <span class="math notranslate nohighlight">\(a \in (0,1)\)</span> 部分。</p></li>
</ul>
</li>
<li><p>参数 <span class="math notranslate nohighlight">\(b &gt; 0\)</span> 是投资加速系数 - 方程
<a class="reference internal" href="#equation-accelerator">(22.2)</a> 表明当收入增加时人们会投资实物资本，当收入减少时会减少投资。</p></li>
</ul>
<p>方程 <a class="reference internal" href="#equation-consumption">(22.1)</a>、<a class="reference internal" href="#equation-accelerator">(22.2)</a> 和 <a class="reference internal" href="#equation-income-identity">(22.3)</a>
推导出以下关于国民收入的二阶线性差分方程：</p>
<div class="math notranslate nohighlight">
\[
Y_t = (a+b) Y_{t-1} - b Y_{t-2} + (\gamma + G_t)
\]</div>
<p>或</p>
<div class="math notranslate nohighlight" id="equation-second-order">
<span class="eqno">(22.4)<a class="headerlink" href="#equation-second-order" title="Permalink to this equation">#</a></span>\[Y_t = \rho_1 Y_{t-1} + \rho_2 Y_{t-2} + (\gamma + G_t)\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\rho_1 = (a+b)\)</span> 且 <span class="math notranslate nohighlight">\(\rho_2 = -b\)</span>。</p>
<p>为完成这个模型，我们需要两个<strong>初始条件</strong>。</p>
<p>如果模型要生成 <span class="math notranslate nohighlight">\(t=0, \ldots, T\)</span> 的时间序列，我们</p>
<p>需要初始值</p>
<div class="math notranslate nohighlight">
\[
Y_{-1} = \bar Y_{-1}, \quad  Y_{-2} = \bar Y_{-2}
\]</div>
<p>我们通常会设置参数<span class="math notranslate nohighlight">\((a,b)\)</span>，使得从任意一对初始条件<span class="math notranslate nohighlight">\((\bar Y_{-1}, \bar Y_{-2})\)</span>开始，国民收入<span class="math notranslate nohighlight">\(Y_t\)</span>在<span class="math notranslate nohighlight">\(t\)</span>变大时会收敛到一个常数值。</p>
<p>我们感兴趣的是研究</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_t\)</span>在收敛到其<strong>稳态</strong>水平过程中的暂时波动</p></li>
<li><p>其收敛到稳态水平的<strong>速率</strong></p></li>
</ul>
<p>到目前为止所描述的确定性版本的模型——意味着没有随机冲击影响总需求——只有暂时的波动。</p>
<p>我们可以通过在总需求中加入随机冲击，将模型转换为具有持续不规则波动的模型。</p>
<section id="id9">
<h3><span class="section-number">22.2.1. </span>模型的随机版本<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>我们通过在方程<a class="reference internal" href="#equation-second-order">(22.4)</a>的右侧加入一个<strong>冲击</strong>或<strong>扰动</strong>的随机过程<span class="math notranslate nohighlight">\(\{\sigma \epsilon_t \}\)</span>，创建模型的<strong>随机</strong>版本，</p>
<p>导致<strong>二阶标量线性随机差分方程</strong>：</p>
<div class="math notranslate nohighlight" id="equation-second-stochastic">
<span class="eqno">(22.5)<a class="headerlink" href="#equation-second-stochastic" title="Permalink to this equation">#</a></span>\[Y_t = G_t + a (1-b) Y_{t-1} - a b Y_{t-2} + \sigma \epsilon_{t}\]</div>
</section>
<section id="id10">
<h3><span class="section-number">22.2.2. </span>模型的数学分析<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>首先，让我们设定 <span class="math notranslate nohighlight">\(G_t \equiv 0\)</span>，<span class="math notranslate nohighlight">\(\sigma = 0\)</span>，以及
<span class="math notranslate nohighlight">\(\gamma = 0\)</span>。</p>
<p>然后我们可以将方程 <a class="reference internal" href="#equation-second-stochastic">(22.5)</a> 写作</p>
<div class="math notranslate nohighlight">
\[
Y_t = \rho_1 Y_{t-1} + \rho_2 Y_{t-2}
\]</div>
<p>或</p>
<div class="math notranslate nohighlight" id="equation-second-stochastic2">
<span class="eqno">(22.6)<a class="headerlink" href="#equation-second-stochastic2" title="Permalink to this equation">#</a></span>\[Y_{t+2} - \rho_1 Y_{t+1} - \rho_2 Y_t  = 0\]</div>
<p>为了发现 <a class="reference internal" href="#equation-second-stochastic2">(22.6)</a> 解的性质，
首先形成 <a class="reference internal" href="#equation-second-stochastic2">(22.6)</a> 的<strong>特征多项式</strong>是很有用的：</p>
<div class="math notranslate nohighlight" id="equation-polynomial">
<span class="eqno">(22.7)<a class="headerlink" href="#equation-polynomial" title="Permalink to this equation">#</a></span>\[z^2 - \rho_1 z  - \rho_2\]</div>
<p>其中 <span class="math notranslate nohighlight">\(z\)</span> 可能是一个复数。</p>
<p>我们想要找到特征多项式的两个<strong>零点</strong>（又称<strong>根</strong>）– 即
<span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span>。</p>
<p>这是两个特殊的 <span class="math notranslate nohighlight">\(z\)</span> 值，即 <span class="math notranslate nohighlight">\(z= \lambda_1\)</span> 和
<span class="math notranslate nohighlight">\(z= \lambda_2\)</span>，如果我们将 <span class="math notranslate nohighlight">\(z\)</span> 设为其中之一</p>
<p>将这些值代入表达式 <a class="reference internal" href="#equation-polynomial">(22.7)</a>，
特征多项式 <a class="reference internal" href="#equation-polynomial">(22.7)</a> 等于零：</p>
<div class="math notranslate nohighlight" id="equation-polynomial-sol">
<span class="eqno">(22.8)<a class="headerlink" href="#equation-polynomial-sol" title="Permalink to this equation">#</a></span>\[z^2 - \rho_1 z  - \rho_2  = (z- \lambda_1 ) (z -\lambda_2) = 0\]</div>
<p>方程 <a class="reference internal" href="#equation-polynomial-sol">(22.8)</a> 被称为特征多项式的<strong>因式分解</strong>。</p>
<p>当根为复数时，它们将以共轭复数对的形式出现。</p>
<p>当根为复数时，用极坐标形式表示它们会比较方便</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 =  r e^{i \omega}, \  \lambda_2 = r e^{-i \omega}
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(r\)</span> 是复数的<em>幅值</em>，而 <span class="math notranslate nohighlight">\(\omega\)</span> 是其<em>角度</em>或<em>相位</em>。</p>
<p>这些也可以表示为</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 = r (cos (\omega) + i \sin (\omega))
\]</div>
<div class="math notranslate nohighlight">
\[
\lambda_2 = r (cos (\omega) - i \sin(\omega))
\]</div>
<p>（要了解极坐标形式，请参见<a class="reference external" href="https://www.khanacademy.org/math/precalculus/x9e81a4f98389efdf:complex/x9e81a4f98389efdf:complex-mul-div-polar/a/complex-number-polar-form-review">这里</a>）</p>
<p>给定<strong>初始条件</strong> <span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>，我们想要生成差分方程 <a class="reference internal" href="#equation-second-stochastic2">(22.6)</a> 的<strong>解</strong>。</p>
<p>它可以表示为</p>
<div class="math notranslate nohighlight">
\[
Y_t = \lambda_1^t c_1 + \lambda_2^t c_2
\]</div>
<p>其中 <span class="math notranslate nohighlight">\(c_1\)</span> 和 <span class="math notranslate nohighlight">\(c_2\)</span> 是取决于两个初始条件和 <span class="math notranslate nohighlight">\(\rho_1, \rho_2\)</span> 的常数。</p>
<p>当根为复数时，进行以下计算是有用的。</p>
<p>注意到</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  Y_t &amp; =  &amp; c_1 (r e^{i \omega})^t + c_2 (r e^{-i \omega})^t  \\
   &amp; = &amp; c_1 r^t e^{i\omega t} + c_2 r^t e^{-i \omega t} \\
   &amp; = &amp;  c_1 r^t [\cos(\omega t) + i \sin(\omega t) ] + c_2 r^t [\cos(\omega t) - i \sin(\omega t) ] \\
   &amp; = &amp; (c_1 + c_2) r^t \cos(\omega t) + i (c_1 - c_2) r^t \sin(\omega t)
 \end{aligned}
\end{split}\]</div>
<p>要使 <span class="math notranslate nohighlight">\(Y_t\)</span> 对每个 <span class="math notranslate nohighlight">\(t\)</span> 都是实数，唯一的方式是 <span class="math notranslate nohighlight">\(c_1 + c_2\)</span> 为实数，而 <span class="math notranslate nohighlight">\(c_1 - c_2\)</span> 为虚数。</p>
<p>这种情况只有当<span class="math notranslate nohighlight">\(c_1\)</span>和<span class="math notranslate nohighlight">\(c_2\)</span>是复共轭时才会发生，此时它们可以用极坐标形式表示为</p>
<div class="math notranslate nohighlight">
\[
c_1 = v e^{i \theta},  \  \ c_2 = v e^{- i \theta}
\]</div>
<p>因此我们可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  Y_t &amp; = &amp; v e^{i \theta} r^t e^{i \omega t} + v e ^{- i \theta} r^t e^{-i \omega t} \\
      &amp; = &amp; v r^t [ e^{i(\omega t + \theta)} + e^{-i (\omega t +\theta)}]  \\
      &amp; = &amp; 2 v r^t  \cos (\omega t + \theta)
 \end{aligned}
\end{split}\]</div>
<p>其中<span class="math notranslate nohighlight">\(v\)</span>和<span class="math notranslate nohighlight">\(\theta\)</span>是必须选择的常数，以满足<span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>的初始条件。</p>
<p>这个公式表明，当根为复数时，<span class="math notranslate nohighlight">\(Y_t\)</span>表现出具有<strong>周期</strong><span class="math notranslate nohighlight">\(\check p = \frac{2 \pi}{\omega}\)</span>和<strong>衰减因子</strong><span class="math notranslate nohighlight">\(r\)</span>的振荡。</p>
<p>我们称<span class="math notranslate nohighlight">\(\check p\)</span>为<strong>周期</strong>，是因为在这段时间内，余弦波<span class="math notranslate nohighlight">\(\cos(\omega t + \theta)\)</span>恰好完成一个完整的周期。</p>
<p>（请画一个余弦函数来说服自己这一点）</p>
<p><strong>注释：</strong> 遵循<span id="id11">[<a class="reference internal" href="zreferences.html#id88" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>，我们要选择模型的参数<span class="math notranslate nohighlight">\(a, b\)</span>，使得特征多项式的（可能是复数的）根<span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span>的绝对值都严格小于1：</p>
<div class="math notranslate nohighlight">
\[
| \lambda_j | &lt; 1 \quad \quad \text{对于 } j = 1, 2
\]</div>
<p><strong>注释：</strong> 当特征多项式的两个根<span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span>的绝对值都严格小于1时，较大根的绝对值决定了模型非随机版本向稳态收敛的速率。</p>
</section>
<section id="id12">
<h3><span class="section-number">22.2.3. </span>本讲内容<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<p>我们编写一个函数来生成<span class="math notranslate nohighlight">\(\{Y_t\}\)</span>序列的模拟，将其作为时间的函数。</p>
<p>该函数需要我们输入<span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>的初始条件。</p>
<p>该函数会检查<span class="math notranslate nohighlight">\(a, b\)</span>的设置是否使得<span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span>的绝对值（也称为”模”）小于1。</p>
<p>该函数还会告诉我们根是否为复数，如果是复数，则会返回它们的实部和虚部。</p>
<p>如果两个根都是实数，函数会返回它们的值。</p>
<p>我们使用编写的函数来模拟随机路径（当<span class="math notranslate nohighlight">\(\sigma &gt;0\)</span>时）。</p>
<p>我们编写函数的方式允许我们输入几种简单形式的<span class="math notranslate nohighlight">\(\{G_t\}\)</span>路径，例如：</p>
<ul class="simple">
<li><p>在某个时间点G的一次性跳跃</p></li>
<li><p>在某个时间点发生的G的永久性跳跃</p></li>
</ul>
<p>我们继续使用萨缪尔森乘数-加速器模型作为实验室来制作一个简单的面向对象编程示例。</p>
<p>决定下一期<span class="math notranslate nohighlight">\(Y_{t+1}\)</span>的”状态”现在不仅仅是当前值<span class="math notranslate nohighlight">\(Y_t\)</span>，还包括滞后一期的值<span class="math notranslate nohighlight">\(Y_{t-1}\)</span>。</p>
<p>这需要比索洛模型类定义更多的记录工作。</p>
<p>我们使用萨缪尔森乘数-加速器模型作为载体，来教授如何逐步为类添加更多功能。</p>
<p>我们希望在类中有一个方法可以自动生成模拟，既可以是非随机的（<span class="math notranslate nohighlight">\(\sigma=0\)</span>）也可以是随机的（<span class="math notranslate nohighlight">\(\sigma &gt; 0\)</span>）。</p>
<p>我们还将展示如何将 Samuelson 模型映射到<a class="reference external" href="https://python.quantecon.org/linear_models.html">这里</a>描述的<code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code>类的一个简单实例中。</p>
<p>我们可以使用<code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code>实例来完成上面用我们自制函数和类所做的各种事情。</p>
<p>除此之外，我们通过示例说明，我们用来形成 Samuelson 模型的<code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code>类实例的矩阵 <span class="math notranslate nohighlight">\(A\)</span> 的特征值，等于 Samuelson 乘数加速器模型的特征多项式<a class="reference internal" href="#equation-polynomial">(22.7)</a>的根。</p>
<p>以下是当政府支出为常数 <span class="math notranslate nohighlight">\(G\)</span> 时，线性状态空间系统中矩阵 <span class="math notranslate nohighlight">\(A\)</span> 的公式：</p>
<div class="math notranslate nohighlight">
\[
A = \begin{bmatrix} 1 &amp; 0 &amp; 0 \cr
                      \gamma + G &amp; \rho_1 &amp; \rho_2 \cr
                      0 &amp; 1 &amp; 0 \end{bmatrix}
\]</div>
</section>
</section>
<section id="id13">
<h2><a class="toc-backref" href="#id33"><span class="section-number">22.3. </span>实现</a><a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h2>
<p>我们从 <span id="id14">[<a class="reference internal" href="zreferences.html#id210" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span> 第189页开始绘制一个信息丰富的图表</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">param_plot</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;该函数创建了Sargent宏观经济理论第二版(1987年)第189页的图表。</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># 设置坐标轴</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="n">ymin</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

    <span class="c1"># 设置坐标轴标签</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_1$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

    <span class="c1"># 绘制(t1, t2)点</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">ρ1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ρ1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="c1"># 关闭普通坐标轴</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># 添加表示坐标轴的箭头</span>
    <span class="n">axes_arrows</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;|-|&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">axes_arrows</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">axes_arrows</span><span class="p">)</span>

    <span class="c1"># 在图上标注方程</span>
    <span class="n">plot_arrowsl</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;connectionstyle&#39;</span><span class="p">:</span> <span class="s2">&quot;arc3, rad=-0.2&quot;</span><span class="p">}</span>
    <span class="n">plot_arrowsr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-|&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;connectionstyle&#39;</span><span class="p">:</span> <span class="s2">&quot;arc3, rad=0.2&quot;</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_1 + \rho_2 &lt; 1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_1 + \rho_2 = 1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_2 &lt; 1 + \rho_1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_2 = 1 + \rho_1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_2 = -1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\rho_1}^2 + 4\rho_2 = 0$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\rho_1}^2 + 4\rho_2 &lt; 0$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>

    <span class="c1"># 标注解的类别</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;爆炸性</span><span class="se">\n</span><span class="s1">增长&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;爆炸性</span><span class="se">\n</span><span class="s1">振荡&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;爆炸性振荡&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;阻尼振荡&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># 在y轴上添加小标记</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.005</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">0.495</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.505</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="s1">&#39;-1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="n">param_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3888a3768163b9c6192f64a742929b735383286bd2017d72c404493ef15ef203.png" src="_images/3888a3768163b9c6192f64a742929b735383286bd2017d72c404493ef15ef203.png" />
</div>
</div>
<p>该图显示了在萨缪尔森模型中由差分方程参数对<span class="math notranslate nohighlight">\((\rho_1 = (a+b), \rho_2 = - b)\)</span>所隐含的<span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>根对所在的区域，这些区域表示：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>是复数且模小于<span class="math notranslate nohighlight">\(1\)</span> - 在这种情况下，<span class="math notranslate nohighlight">\(\{Y_t\}\)</span>序列呈现衰减振荡。</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>都是实数，但其中一个严格大于<span class="math notranslate nohighlight">\(1\)</span> - 这导致爆炸性增长。</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>都是实数，但其中一个严格小于<span class="math notranslate nohighlight">\(-1\)</span> - 这导致爆炸性振荡。</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>都是实数且绝对值都小于<span class="math notranslate nohighlight">\(1\)</span> - 在这种情况下，会平滑地收敛到稳态，没有衰减循环。</p></li>
</ul>
<p>稍后我们将在图上用红色标记显示由<span class="math notranslate nohighlight">\((a,b)\)</span>设置所隐含的特定点。</p>
<section id="id15">
<h3><span class="section-number">22.3.1. </span>描述特征多项式含义的函数<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;该函数接收ρ1和ρ2的值，并用它们</span>
<span class="sd">    来分类解的类型</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ρ2</span>
    <span class="k">if</span> <span class="n">ρ2</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ρ1</span> <span class="ow">or</span> <span class="n">ρ2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;爆炸性振荡&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ρ1</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;爆炸性增长&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">discriminant</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根是复数且模小于1；</span><span class="se">\</span>
<span class="s1">因此是衰减振荡&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根是实数且绝对值小于1；</span><span class="se">\</span>
<span class="s1">因此平滑收敛到稳态&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### 测试categorize_solution函数</span>

<span class="n">categorize_solution</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>根是实数且绝对值小于1；因此平滑收敛到稳态
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3><span class="section-number">22.3.2. </span>绘制路径的函数<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<p>对于我们接下来的工作，以下是一个有用的函数</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_y</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;该函数用于绘制 Y_t 的路径&quot;&quot;&quot;</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;时间 $t$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$Y_t$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h3><span class="section-number">22.3.3. </span>手动或”人工”求根计算<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<p>以下函数使用高中代数方法计算特征多项式的根。</p>
<p>（我们稍后会用其他方法计算根）</p>
<p>该函数还根据我们设置的初始条件绘制 <span class="math notranslate nohighlight">\(Y_t\)</span> 的图像</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 这是一个&#39;手动&#39;方法</span>

<span class="k">def</span> <span class="nf">y_nonstochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">.92</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;接收参数值并计算特征多项式的根。它会说明这些根是实根还是复根，</span>
<span class="sd">    以及它们的绝对值是否小于1。它还会根据给定的两个国民收入初始条件</span>
<span class="sd">    计算长度为n的模拟序列</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ρ_1 是 </span><span class="si">{</span><span class="n">ρ1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ρ_2 是 </span><span class="si">{</span><span class="n">ρ2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ρ2</span>

    <span class="k">if</span> <span class="n">discriminant</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;单个实根：&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roots</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">discriminant</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;两个实根：&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roots</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;两个复根：&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roots</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值都小于1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值不都小于1&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span> <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span>

    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">y_t</span>

<span class="n">plot_y</span><span class="p">(</span><span class="n">y_nonstochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ρ_1 是 1.42
ρ_2 是 -0.5
两个实根：
[-0.6459687576256715, -0.7740312423743284]
根的绝对值都小于1
</pre></div>
</div>
<img alt="_images/47f369ba70c9db9ef14953275a285bf3d54eb50e21c88b4ea05c4b1267e0a023.png" src="_images/47f369ba70c9db9ef14953275a285bf3d54eb50e21c88b4ea05c4b1267e0a023.png" />
</div>
</div>
</section>
<section id="id18">
<h3><span class="section-number">22.3.4. </span>反向工程参数以生成阻尼周期<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h3>
<p>下一个单元格编写的代码以极坐标形式的一对共轭复数的模 <span class="math notranslate nohighlight">\(r\)</span> 和相位 <span class="math notranslate nohighlight">\(\phi\)</span> 作为输入</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 = r \exp(i \phi), \quad \lambda_2 = r \exp(- i \phi)
\]</div>
<ul class="simple">
<li><p>代码假设这两个复数是特征多项式的根</p></li>
<li><p>然后反向推导出能生成这些根的 <span class="math notranslate nohighlight">\((a,b)\)</span> 和 <span class="math notranslate nohighlight">\((\rho_1, \rho_2)\)</span> 对</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### 反向工程周期的代码</span>
<span class="c1">### y_t = r^t (c_1 cos(ϕ t) + c2 sin(ϕ t))</span>
<span class="c1">###</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    接收复数 r exp(j ϕ) 的模 r 和角度 ϕ，</span>
<span class="sd">    并创建特征多项式的 ρ1 和 ρ2，其中</span>
<span class="sd">    r exp(j ϕ) 和 r exp(- j ϕ) 是复根。</span>

<span class="sd">    返回验证这些根的乘数系数 a 和加速器系数 b。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>  <span class="c1"># 生成两个复根</span>
    <span class="n">g2</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="n">ϕ</span><span class="p">)</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">g2</span>           <span class="c1"># 隐含的 ρ1, ρ2</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">g1</span> <span class="o">*</span> <span class="n">g2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="n">ρ2</span>                <span class="c1"># 反向推导验证这些的 a 和 b</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>

<span class="c1">## 现在让我们在示例中使用这个函数</span>
<span class="c1">## 这里是示例参数</span>

<span class="n">r</span> <span class="o">=</span> <span class="mf">.95</span>
<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>                <span class="c1"># 时间单位中的周期长度</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">period</span>

<span class="c1">## 应用函数</span>

<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a, b = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1, ρ2 = </span><span class="si">{</span><span class="n">ρ1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ρ2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a, b = (0.6346322893124001+0j), (0.9024999999999999-0j)
ρ1, ρ2 = (1.5371322893124+0j), (-0.9024999999999999+0j)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 打印 ρ1 和 ρ2 的实部</span>

<span class="n">ρ1</span> <span class="o">=</span> <span class="n">ρ1</span><span class="o">.</span><span class="n">real</span>
<span class="n">ρ2</span> <span class="o">=</span> <span class="n">ρ2</span><span class="o">.</span><span class="n">real</span>

<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.5371322893124, -0.9024999999999999)
</pre></div>
</div>
</div>
</div>
</section>
<section id="numpy">
<h3><span class="section-number">22.3.5. </span>使用Numpy求根<a class="headerlink" href="#numpy" title="Permalink to this heading">#</a></h3>
<p>我们将使用numpy来计算特征多项式的根</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;r, ϕ = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ϕ</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p1, p2 = </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># print(f&quot;g1, g2 = {g1}, {g2}&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a, b = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1, ρ2 = </span><span class="si">{</span><span class="n">ρ1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ρ2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r, ϕ = 0.95, 0.6283185307179586
p1, p2 = (0.95, 0.6283185307179586), (0.95, -0.6283185307179586)
a, b = (0.6346322893124001+0j), (0.9024999999999999-0j)
ρ1, ρ2 = 1.5371322893124, -0.9024999999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##=== 此方法使用numpy计算根 ===#</span>


<span class="k">def</span> <span class="nf">y_nonstochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; 这个函数使用numpy来帮我们计算特征多项式的根，</span>
<span class="sd">    而不是像之前那样手动计算</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 有用的常数</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

    <span class="n">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">)</span>

    <span class="c1"># 求多项式的根</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;根为 </span><span class="si">{</span><span class="n">roots</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># 检查是实根还是复根</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根为复数&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根为实数&#39;</span><span class="p">)</span>

    <span class="c1"># 检查根的绝对值是否小于1</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值小于1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值不小于1&#39;</span><span class="p">)</span>

    <span class="c1"># 定义转移方程</span>
    <span class="k">def</span> <span class="nf">transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span> <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span>

    <span class="c1"># 设置初始条件</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

    <span class="c1"># 生成y_t序列</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">y_t</span>

<span class="n">plot_y</span><span class="p">(</span><span class="n">y_nonstochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>根是复数且模小于1；因此是衰减振荡
根为 [0.85+0.27838822j 0.85-0.27838822j]
根为复数
根的绝对值小于1
</pre></div>
</div>
<img alt="_images/f017a15c183a6a8fd4344e05d491989624c0e8d3c0935a3b0e84f2d23705a140.png" src="_images/f017a15c183a6a8fd4344e05d491989624c0e8d3c0935a3b0e84f2d23705a140.png" />
</div>
</div>
</section>
<section id="id19">
<h3><span class="section-number">22.3.6. </span>反向工程复数根：示例<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h3>
<p>下一个单元研究反向工程复数根的含义。</p>
<p>我们将生成一个周期为10的<strong>无阻尼</strong>循环</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># 生成无阻尼、非爆炸性循环</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>   <span class="c1"># 时间单位中的循环长度</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">period</span>

<span class="c1">## 应用反向工程函数f</span>

<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="c1"># 去掉虚部，使其成为y_nonstochastic的有效输入</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a, b = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ytemp</span> <span class="o">=</span> <span class="n">y_nonstochastic</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plot_y</span><span class="p">(</span><span class="n">ytemp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a, b = 0.6180339887498949, 1.0
根是复数且模小于1；因此是衰减振荡
根为 [0.80901699+0.58778525j 0.80901699-0.58778525j]
根为复数
根的绝对值小于1
</pre></div>
</div>
<img alt="_images/2660bbd46829ba1406fe0f58680f8e2740ce0cebae0a6f7f6f93e585e462a608.png" src="_images/2660bbd46829ba1406fe0f58680f8e2740ce0cebae0a6f7f6f93e585e462a608.png" />
</div>
</div>
</section>
<section id="sympy">
<h3><span class="section-number">22.3.7. </span>题外话：使用 Sympy 求根<a class="headerlink" href="#sympy" title="Permalink to this heading">#</a></h3>
<p>我们也可以使用 sympy 来计算根的解析公式</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_printing</span><span class="p">()</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;ρ_1&quot;</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;ρ_2&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">r2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ \frac{ρ_{1}}{2} - \frac{\sqrt{ρ_{1}^{2} + 4 ρ_{2}}}{2}, \  \frac{ρ_{1}}{2} + \frac{\sqrt{ρ_{1}^{2} + 4 ρ_{2}}}{2}\right]\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;α&quot;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;β&quot;</span><span class="p">)</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">r2</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>

<span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">r2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ \frac{α}{2} + \frac{β}{2} - \frac{\sqrt{α^{2} + 2 α β + β^{2} - 4 β}}{2}, \  \frac{α}{2} + \frac{β}{2} + \frac{\sqrt{α^{2} + 2 α β + β^{2} - 4 β}}{2}\right]\]</div>
</div>
</div>
</section>
</section>
<section id="id20">
<h2><a class="toc-backref" href="#id34"><span class="section-number">22.4. </span>随机冲击</a><a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h2>
<p>现在我们将构建一些代码来模拟模型的随机版本，这个版本是通过在总需求中添加随机冲击过程而产生的</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">y_stochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;该函数接收模型随机版本的参数，</span>
<span class="sd">    并分析特征多项式的根，</span>
<span class="sd">    同时生成一个模拟。</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 有用的常数</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

    <span class="c1"># 对解进行分类</span>
    <span class="n">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">)</span>

    <span class="c1"># 求多项式的根</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>

    <span class="c1"># 检查是实根还是复根</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根是复数&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根是实数&#39;</span><span class="p">)</span>

    <span class="c1"># 检查根的绝对值是否小于1</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值小于1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值不小于1&#39;</span><span class="p">)</span>

    <span class="c1"># 生成冲击</span>
    <span class="n">ϵ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># 定义转移方程</span>
    <span class="k">def</span> <span class="nf">transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span> <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> \
        <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span> <span class="o">+</span> <span class="n">σ</span> <span class="o">*</span> <span class="n">ϵ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

    <span class="c1"># 设置初始条件</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

    <span class="c1"># 生成y_t序列</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">y_t</span>

<span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>根是实数且绝对值小于1；因此平滑收敛到稳态
[0.7236068 0.2763932]
根是实数
根的绝对值小于1
</pre></div>
</div>
<img alt="_images/e97f952bd0d8c8f78d417b52d9870fe0e968bec29af269adafd8427127140d77.png" src="_images/e97f952bd0d8c8f78d417b52d9870fe0e968bec29af269adafd8427127140d77.png" />
</div>
</div>
<p>让我们进行一个模拟，其中存在冲击且特征多项式具有复根</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mf">.97</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>   <span class="c1"># 时间单位中的周期长度</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">period</span>

<span class="c1">### 应用反向工程函数f</span>

<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="c1"># 去掉虚部，使其成为y_nonstochastic的有效输入</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a, b = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">y_1</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a, b = 0.6285929690873979, 0.9409000000000001
根是复数且模小于1；因此是衰减振荡
[0.78474648+0.57015169j 0.78474648-0.57015169j]
根是复数
根的绝对值小于1
</pre></div>
</div>
<img alt="_images/0bbfa5852cb9c0bfcaaf231476bf40e11dcfaa1ec6d7b87d38b673e8e8f7d2cd.png" src="_images/0bbfa5852cb9c0bfcaaf231476bf40e11dcfaa1ec6d7b87d38b673e8e8f7d2cd.png" />
</div>
</div>
</section>
<section id="id21">
<h2><a class="toc-backref" href="#id35"><span class="section-number">22.5. </span>政府支出</a><a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h2>
<p>此函数计算对政府支出的永久性或一次性增加的响应</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">y_stochastic_g</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                   <span class="n">y_1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                   <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                   <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                   <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                   <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                   <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">g_t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">duration</span><span class="o">=</span><span class="s1">&#39;permanent&#39;</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;此程序计算在时间20发生的政府支出</span>
<span class="sd">    永久性增加的响应</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 有用的常数</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

    <span class="c1"># 对解进行分类</span>
    <span class="n">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">)</span>

    <span class="c1"># 找出多项式的根</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>

    <span class="c1"># 检查是实数还是复数</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根为复数&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根为实数&#39;</span><span class="p">)</span>

    <span class="c1"># 检查根是否小于1</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根小于1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根不小于1&#39;</span><span class="p">)</span>

    <span class="c1"># 生成冲击</span>
    <span class="n">ϵ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>

        <span class="c1"># 非随机 - 分开以避免在不需要时</span>
        <span class="c1"># 生成随机序列</span>
        <span class="k">if</span> <span class="n">σ</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span> <span class="o">+</span> <span class="n">g</span>

        <span class="c1"># 随机</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ϵ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span> <span class="o">+</span> <span class="n">g</span> <span class="o">+</span> <span class="n">σ</span> <span class="o">*</span> <span class="n">ϵ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

    <span class="c1"># 创建列表并设置初始条件</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

    <span class="c1"># 生成y_t序列</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

        <span class="c1"># 无政府支出</span>
        <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

        <span class="c1"># 政府支出（无冲击）</span>
        <span class="k">elif</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">duration</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

        <span class="c1"># 永久性政府支出冲击</span>
        <span class="k">elif</span> <span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;permanent&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">g_t</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">))</span>

        <span class="c1"># 一次性政府支出冲击</span>
        <span class="k">elif</span> <span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;one-off&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">g_t</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">y_t</span>
</pre></div>
</div>
</div>
</div>
<p>可以按以下方式模拟永久性政府支出冲击</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic_g</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s1">&#39;permanent&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>根是实数且绝对值小于1；因此平滑收敛到稳态
[0.7236068 0.2763932]
根为实数
根小于1
</pre></div>
</div>
<img alt="_images/361aa72d16777ea81399b25ac113c185a325aeb281e49ecaeb26c3d1930ba57d.png" src="_images/361aa72d16777ea81399b25ac113c185a325aeb281e49ecaeb26c3d1930ba57d.png" />
</div>
</div>
<p>我们还可以观察一次性政府支出增加所带来的响应</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic_g</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s1">&#39;one-off&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>根是实数且绝对值小于1；因此平滑收敛到稳态
[0.7236068 0.2763932]
根为实数
根小于1
</pre></div>
</div>
<img alt="_images/f0eaf923648d68f69faa67701901b833ffeb8eb044e58f0a4a4491b0ffc42790.png" src="_images/f0eaf923648d68f69faa67701901b833ffeb8eb044e58f0a4a4491b0ffc42790.png" />
</div>
</div>
</section>
<section id="id22">
<h2><a class="toc-backref" href="#id36"><span class="section-number">22.6. </span>将所有内容封装到类中</a><a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h2>
<p>到目前为止，我们已经编写了函数来完成工作。</p>
<p>现在让我们撸起袖子，为萨缪尔森模型编写一个名为<code class="docutils literal notranslate"><span class="pre">Samuelson</span></code>的Python类</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Samuelson</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;这个类代表萨缪尔森模型，也称为多重加速器模型。该模型将凯恩斯乘数与</span>
<span class="sd">    投资加速器理论相结合。</span>

<span class="sd">    产出路径由线性二阶差分方程控制</span>

<span class="sd">    .. math::</span>

<span class="sd">        Y_t =  + \alpha (1 + \beta) Y_{t-1} - \alpha \beta Y_{t-2}</span>

<span class="sd">    参数</span>
<span class="sd">    ----------</span>
<span class="sd">    y_0 : 标量</span>
<span class="sd">        Y_0的初始条件</span>
<span class="sd">    y_1 : 标量</span>
<span class="sd">        Y_1的初始条件</span>
<span class="sd">    α : 标量</span>
<span class="sd">        边际消费倾向</span>
<span class="sd">    β : 标量</span>
<span class="sd">        加速器系数</span>
<span class="sd">    n : 整数</span>
<span class="sd">        迭代次数</span>
<span class="sd">    σ : 标量</span>
<span class="sd">        波动性参数。必须大于或等于0。设为0表示非随机模型。</span>
<span class="sd">    g : 标量</span>
<span class="sd">        政府支出冲击</span>
<span class="sd">    g_t : 整数</span>
<span class="sd">        政府支出冲击发生的时间。当duration != None时必须指定。</span>
<span class="sd">    duration : {None, &#39;permanent&#39;, &#39;one-off&#39;}</span>
<span class="sd">        指定政府支出冲击的类型。如果为none，则所有t的政府支出等于g。</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">y_1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">α</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span>
                 <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">σ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">g_t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">=</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">g_t</span><span class="p">,</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">=</span> <span class="n">γ</span><span class="p">,</span> <span class="n">σ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">root_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;复共轭&#39;</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;双实根&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;单实根&#39;</span>

    <span class="k">def</span> <span class="nf">root_less_than_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">solution_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span>
        <span class="n">discriminant</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ρ2</span>
        <span class="k">if</span> <span class="n">ρ2</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ρ1</span> <span class="ow">or</span> <span class="n">ρ2</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;爆炸性振荡&#39;</span>
        <span class="k">elif</span> <span class="n">ρ1</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;爆炸性增长&#39;</span>
        <span class="k">elif</span> <span class="n">discriminant</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;阻尼振荡&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;稳态&#39;</span>

    <span class="k">def</span> <span class="nf">_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>

        <span class="c1"># 非随机 - 分开以避免在不需要时生成随机序列</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span>

        <span class="c1"># 随机</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ϵ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span> \
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">*</span> <span class="n">ϵ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">generate_series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># 创建列表并设置初始条件</span>
        <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">]</span>

        <span class="c1"># 生成y_t序列</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>

            <span class="c1"># 无政府支出</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

            <span class="c1"># 政府支出(无冲击)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

            <span class="c1"># 永久性政府支出冲击</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;permanent&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">:</span>
                    <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>

            <span class="c1"># 一次性政府支出冲击</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;one-off&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">:</span>
                    <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">y_t</span>

    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;摘要</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;根的类型: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_type</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;解的类型: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;根: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_less_than_one</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值小于1&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;根的绝对值不小于1&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;随机序列，σ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;非随机序列&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;政府支出等于 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span>
                  <span class="s1">&#39; 政府支出冲击发生在 t = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_series</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;迭代次数&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$Y_t$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

        <span class="c1"># 在图中添加参数值</span>
        <span class="n">paramstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$ </span><span class="se">\n</span><span class="s1"> $</span><span class="se">\\</span><span class="s1">beta=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$ </span><span class="se">\n</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">        $</span><span class="se">\\</span><span class="s1">gamma=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$ </span><span class="se">\n</span><span class="s1"> $</span><span class="se">\\</span><span class="s1">sigma=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$ </span><span class="se">\n</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">        $</span><span class="se">\\</span><span class="s1">rho_1=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$ </span><span class="se">\n</span><span class="s1"> $</span><span class="se">\\</span><span class="s1">rho_2=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">paramstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">param_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># 使用之前定义的param_plot()函数(这样它既可以单独使用，</span>
        <span class="c1"># 也可以作为模型的一部分使用)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">param_plot</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="c1"># 在图例中添加λ值</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">root</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>
                <span class="c1"># 需要为正数填充运算符，因为字符串被分开</span>
                <span class="n">operator</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;$\lambda_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">sam</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">operator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">sam</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">i$&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;$\lambda_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">sam</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span> <span class="c1"># 虚拟点以添加到图例</span>

        <span class="c1"># 在图中添加ρ对</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\ \rho_1, \ \rho_2 \ )$&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
<section id="samuelson">
<h3><span class="section-number">22.6.1. </span>Samuelson类的说明<a class="headerlink" href="#samuelson" title="Permalink to this heading">#</a></h3>
<p>现在我们用一个例子来展示Samuelson类的应用</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span> <span class="o">=</span> <span class="n">Samuelson</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s1">&#39;permanent&#39;</span><span class="p">)</span>
<span class="n">sam</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>摘要
--------------------------------------------------
根的类型: 复共轭
解的类型: 阻尼振荡
根: [0.65+0.27838822j 0.65-0.27838822j]
根的绝对值小于1
随机序列，σ = 2
政府支出等于 10
Permanent 政府支出冲击发生在 t = 20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4576b8636677d9923bacc39c43dc2cacf52ca0a84f3ec75485b469bd752e55f1.png" src="_images/4576b8636677d9923bacc39c43dc2cacf52ca0a84f3ec75485b469bd752e55f1.png" />
</div>
</div>
</section>
<section id="id23">
<h3><span class="section-number">22.6.2. </span>使用图形<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h3>
<p>我们将使用我们的图形来显示根的位置，并说明它们的位置如何与刚才绘制的路径行为相一致。</p>
<p>红色的 <span class="math notranslate nohighlight">\(+\)</span> 符号显示了根的位置</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span><span class="o">.</span><span class="n">param_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/31102a832b4507c890b1daa7e314d4314f396e43a4e8e3b4968559b0b9033176.png" src="_images/31102a832b4507c890b1daa7e314d4314f396e43a4e8e3b4968559b0b9033176.png" />
</div>
</div>
</section>
</section>
<section id="linearstatespace">
<h2><a class="toc-backref" href="#id37"><span class="section-number">22.7. </span>使用LinearStateSpace类</a><a class="headerlink" href="#linearstatespace" title="Permalink to this heading">#</a></h2>
<p>我们可以使用<a class="reference external" href="http://quantecon.org/quantecon-py">QuantEcon.py</a>中的<a class="reference external" href="https://github.com/QuantEcon/QuantEcon.py/blob/master/quantecon/lss.py">LinearStateSpace</a>类来完成我们之前从头开始做的大部分工作。</p>
<p>以下是我们如何将萨缪尔森模型映射到<code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code>类的实例中</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;此脚本将萨缪尔森模型映射到</span>
<span class="sd">``LinearStateSpace``类中</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">α</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
<span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>
<span class="n">γ</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">σ</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span>        <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span>   <span class="n">ρ1</span><span class="p">,</span>     <span class="n">ρ2</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>        <span class="mi">1</span><span class="p">,</span>      <span class="mi">0</span><span class="p">]]</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">[[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="n">ρ1</span><span class="p">,</span>   <span class="n">ρ2</span><span class="p">],</span>         <span class="c1"># 这是Y_{t+1}</span>
     <span class="p">[</span><span class="n">γ</span><span class="p">,</span>      <span class="n">α</span><span class="p">,</span>    <span class="mi">0</span><span class="p">],</span>         <span class="c1"># 这是C_{t+1}</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>      <span class="n">β</span><span class="p">,</span>   <span class="o">-</span><span class="n">β</span><span class="p">]]</span>         <span class="c1"># 这是I_{t+1}</span>

<span class="n">μ_0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">σ</span> <span class="c1"># 随机项</span>

<span class="n">sam_t</span> <span class="o">=</span> <span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">μ_0</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sam_t</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;产出 ($Y_t$)&#39;</span><span class="p">,</span> <span class="s1">&#39;消费 ($C_t$)&#39;</span><span class="p">,</span> <span class="s1">&#39;投资 ($I_t$)&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;迭代次数&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a5c2c8c9a661697ee51842f1fc8c040b7dad6f079e92243423a6791a86de3248.png" src="_images/a5c2c8c9a661697ee51842f1fc8c040b7dad6f079e92243423a6791a86de3248.png" />
</div>
</div>
<section id="id24">
<h3><span class="section-number">22.7.1. </span><code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 类中的其他方法<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<p>让我们使用 <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 类中的方法为萨缪尔森模型的实例绘制<strong>脉冲响应函数</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imres</span> <span class="o">=</span> <span class="n">sam_t</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">()</span>
<span class="n">imres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">imres</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">imres</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">imres</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left( 2, \  6, \  1\right)\]</div>
</div>
</div>
<p>现在让我们通过计算矩阵<span class="math notranslate nohighlight">\(A\)</span>的特征值来求解特征多项式的零点</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.85+0.42130749j 0.85-0.42130749j 1.  +0.j        ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id25">
<h3><span class="section-number">22.7.2. </span>从 <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 继承方法<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
<p>我们也可以创建 <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> 的子类（继承其所有方法和属性）来添加更多可用的函数</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SamuelsonLSS</span><span class="p">(</span><span class="n">LinearStateSpace</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这个子类将萨缪尔森乘数-加速器模型</span>
<span class="sd">    创建为线性状态空间系统。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">y_1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                 <span class="n">β</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                 <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">σ</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">=</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">=</span> <span class="n">γ</span><span class="p">,</span> <span class="n">σ</span>

        <span class="c1"># 定义初始条件</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">μ_0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

        <span class="c1"># 定义转移矩阵</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span>                 <span class="mi">0</span><span class="p">,</span>         <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span>       <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span>                 <span class="mi">1</span><span class="p">,</span>         <span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># 定义输出矩阵</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="p">[[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">],</span>         <span class="c1"># 这是 Y_{t+1}</span>
                  <span class="p">[</span><span class="n">γ</span><span class="p">,</span>           <span class="n">α</span><span class="p">,</span>       <span class="mi">0</span><span class="p">],</span>         <span class="c1"># 这是 C_{t+1}</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span>           <span class="n">β</span><span class="p">,</span>      <span class="o">-</span><span class="n">β</span><span class="p">]]</span>         <span class="c1"># 这是 I_{t+1}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">σ</span>  <span class="c1"># 随机项</span>

        <span class="c1"># 用萨缪尔森模型的参数初始化 LSS</span>
        <span class="n">LinearStateSpace</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">μ_0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="c1"># 临时存储原始参数</span>
        <span class="n">temp_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span>
        <span class="n">temp_Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_0</span>

        <span class="c1"># 将分布参数设置为其平稳值用于模拟</span>
        <span class="k">if</span> <span class="n">stationary</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_yx</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">stationary_distributions</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_x</span>
            <span class="c1"># 计算平稳分布时未能收敛的异常情况</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;平稳分布不存在&#39;</span><span class="p">)</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;产出 ($Y_t$)&#39;</span><span class="p">,</span> <span class="s1">&#39;消费 ($C_t$)&#39;</span><span class="p">,</span> <span class="s1">&#39;投资 ($I_t$)&#39;</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;迭代次数&#39;</span><span class="p">)</span>

        <span class="c1"># 将分布参数重置为初始值</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span> <span class="o">=</span> <span class="n">temp_mu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_0</span> <span class="o">=</span> <span class="n">temp_Sigma</span>

        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">plot_irf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

        <span class="c1"># 重塑为 3 x j 矩阵用于绘图</span>
        <span class="n">yimf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$Y_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$C_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$I_t$&#39;</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">yimf</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;脉冲响应函数&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;迭代次数&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">multipliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id26">
<h3><span class="section-number">22.7.3. </span>图示<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h3>
<p>让我们展示如何使用<code class="docutils literal notranslate"><span class="pre">SamuelsonLSS</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33b72475ac544fdb148ca8a1bc686931d4587ca13bb744eae97642c4a0347103.png" src="_images/33b72475ac544fdb148ca8a1bc686931d4587ca13bb744eae97642c4a0347103.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f2933c79717cf12f0a85f14e3f4ee41e33d1bcf88cc860bc31d930a94d2591a4.png" src="_images/f2933c79717cf12f0a85f14e3f4ee41e33d1bcf88cc860bc31d930a94d2591a4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_irf</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d437bf085fc1c2917c1015a2ef2c84c025c87a5b885dd917b813738138ece54b.png" src="_images/d437bf085fc1c2917c1015a2ef2c84c025c87a5b885dd917b813738138ece54b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">multipliers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([7.414389, 6.835896, 0.578493])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id27">
<h2><a class="toc-backref" href="#id38"><span class="section-number">22.8. </span>纯乘数模型</a><a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h2>
<p>让我们通过设置 <span class="math notranslate nohighlight">\(b=0\)</span> 来关闭加速器，得到一个纯乘数模型</p>
<ul class="simple">
<li><p>缺少周期性的现象说明了为什么萨缪尔森要引入加速器</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6da342b34879b6b39248794f1845e1fad6abb00ea8d7ffcdfa4ce708d380e9ee.png" src="_images/6da342b34879b6b39248794f1845e1fad6abb00ea8d7ffcdfa4ce708d380e9ee.png" />
<img alt="_images/6da342b34879b6b39248794f1845e1fad6abb00ea8d7ffcdfa4ce708d380e9ee.png" src="_images/6da342b34879b6b39248794f1845e1fad6abb00ea8d7ffcdfa4ce708d380e9ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/427e395f2520cf6ded4c3f11a9f2dcd278552895c3a9cfef58ccd829280a6003.png" src="_images/427e395f2520cf6ded4c3f11a9f2dcd278552895c3a9cfef58ccd829280a6003.png" />
<img alt="_images/427e395f2520cf6ded4c3f11a9f2dcd278552895c3a9cfef58ccd829280a6003.png" src="_images/427e395f2520cf6ded4c3f11a9f2dcd278552895c3a9cfef58ccd829280a6003.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_irf</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/742592a7eb34aacdd725677f6f4a00d8774676824127fb4bdb735b04d7661fca.png" src="_images/742592a7eb34aacdd725677f6f4a00d8774676824127fb4bdb735b04d7661fca.png" />
<img alt="_images/742592a7eb34aacdd725677f6f4a00d8774676824127fb4bdb735b04d7661fca.png" src="_images/742592a7eb34aacdd725677f6f4a00d8774676824127fb4bdb735b04d7661fca.png" />
</div>
</div>
</section>
<section id="id28">
<h2><a class="toc-backref" href="#id39"><span class="section-number">22.9. </span>总结</a><a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h2>
<p>在本讲中，我们编写了函数和类来表示萨缪尔森(1939)乘数-加速器模型的非随机和随机版本，该模型在<span id="id29">[<a class="reference internal" href="zreferences.html#id88" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>中有所描述。</p>
<p>我们看到不同的参数值会导致不同的输出路径，这些路径可能是平稳的、发散的或振荡的。</p>
<p>我们还能够使用<a class="reference external" href="http://quantecon.org/quantecon-py">QuantEcon.py</a>的<a class="reference external" href="https://github.com/QuantEcon/QuantEcon.py/blob/master/quantecon/lss.py">LinearStateSpace</a>类来表示该模型。</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  工具与技术
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. 新冠病毒建模
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. 线性代数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR分解
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. 循环矩阵
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. 奇异值分解（SVD）
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. 向量自回归和动态模态分解
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. 使用牛顿法求解经济模型
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  基础统计学
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. 基础概率论与矩阵
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   9. 大数定律 和 中心极限定理
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   10. 概率的两种含义
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   11. 多元超几何分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   12. 多元正态分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   13. 故障树不确定性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   14. 人工神经网络简介
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   15. 随机化回应调查
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   16. 随机回答的期望效用
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  线性规划
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   17. 最优传输
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   18. 冯·诺依曼增长模型（及其推广）
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  动态系统导论
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   19. 有限马尔可夫链
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   20. 库存动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   21. 线性状态空间模型
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   22. 萨缪尔森乘数-加速器模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   23. Kesten过程与企业动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   24. 财富分配动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   25. 卡尔曼滤波初探
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   26. 卡尔曼滤波器的另一个视角
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  搜索
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   27. 求职搜索 I: McCall搜寻模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   28. 求职搜索 II：搜寻与离职
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   29. 求职搜索 III: 拟合值函数迭代
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   30. 求职搜索 IV：相关工资报价
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   31. 求职搜索 V：职业选择建模
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   32. 求职搜索 VI：在职搜索
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   33. 求职搜索 VII：McCall劳动者的Q学习
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  消费、储蓄与资本
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   34. Cass-Koopmans模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   35. Cass-Koopmans竞争均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   36. 带扭曲性税收的Cass-Koopmans模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   37. 重叠世代模型中的转换
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   38. 蛋糕食用问题 I：最优储蓄导论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   39. 蛋糕食用问题 II：数值方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   40. 最优增长 I：随机最优增长模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   41. 最优增长 II：使用Numba加速代码
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   42. 最优增长 III：时间迭代
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   43. 最优增长 IV：内生网格法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   44. 收入波动问题 I：基本模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   45. 收入波动问题 II：资产随机收益
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  贝叶斯定律
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   46. 非共轭先验
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   47. AR(1)参数的后验分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   48. 预测 AR(1) 过程
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  信息论
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. 求职搜索 VII: 带学习的搜索
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   50. 似然比过程
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   51. 计算似然比过程的均值
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   52. 让弥尔顿·弗里德曼困惑的问题
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   53. 可交换性和贝叶斯更新
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   54. 似然比过程和贝叶斯学习
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   55. 错误模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   56. 贝叶斯与频率主义决策规则的比较
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ控制
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   57. LQ控制：基础
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   58. LQ控制的拉格朗日方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   59. 消除交叉项
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   60. 永久收入模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   61. 永久收入 II：线性二次方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   62. 通过库存实现生产平滑
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  多主体模型
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   63. 就业和失业的湖泊模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   64. 理性预期均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   65. 线性理性预期模型中的稳定性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   66. 马尔可夫完美均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   67. 不确定性陷阱
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   68. 艾亚加里模型
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  资产定价与金融
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   69. 资产定价：有限状态模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   70. 带有阿罗证券的竞争均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   71. 异质信念与泡沫
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  数据与实证
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   72. 面板数据的Pandas使用
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   73. Python线性回归
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   74. 最大似然估计
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  拍卖
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   75. 一价和二价拍卖
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   76. 多种商品分配机制
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  其他
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   77. 故障排除
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   78. 参考文献
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   79. 执行统计
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/samuelson.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/samuelson.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/samuelson.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.zh-cn.notebooks" data-urlpath="tree/lecture-python.zh-cn.notebooks/samuelson.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/samuelson.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "samuelson";
                const repoURL = "https://github.com/QuantEcon/lecture-python.zh-cn.notebooks";
                const urlPath = "tree/lecture-python.zh-cn.notebooks/samuelson.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>