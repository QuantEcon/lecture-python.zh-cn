
<!DOCTYPE html>


<html lang="zh-CN" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. QRåˆ†è§£ &#8212; Pythonä¸­çº§æ•°é‡ç»æµå­¦</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=3bd9fcddbe64f63e07c8604843d1cc622a07b430" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=946197a6"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=30f7c850c5b005eca2ad6e48893cd350a6c6c4c2"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'qr_decomp';</script>
    <link rel="canonical" href="https://python.quantecon-zh-cn.org/qr_decomp.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="ç´¢å¼•" href="genindex.html" />
    <link rel="search" title="æœç´¢" href="search.html" />
    <link rel="next" title="4. å¾ªç¯çŸ©é˜µ" href="eig_circulant.html" />
    <link rel="prev" title="2. çº¿æ€§ä»£æ•°" href="linear_algebra.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=æœ¬è¯¾ç¨‹æ˜¯ç”±æ‰˜é©¬æ–¯Â·è¨é‡‘ç‰¹ï¼ˆThomas J. Sargentï¼‰å’Œçº¦ç¿°Â·æ–¯å¡”èƒ¡æ–¯åŸºï¼ˆJohn Stachurskiï¼‰è®¾è®¡å’Œç¼–å†™çš„æ•°é‡ç»æµå»ºæ¨¡è®²åº§ã€‚ />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="QRåˆ†è§£"/>
<meta name="twitter:description" content="æœ¬è¯¾ç¨‹æ˜¯ç”±æ‰˜é©¬æ–¯Â·è¨é‡‘ç‰¹ï¼ˆThomas J. Sargentï¼‰å’Œçº¦ç¿°Â·æ–¯å¡”èƒ¡æ–¯åŸºï¼ˆJohn Stachurskiï¼‰è®¾è®¡å’Œç¼–å†™çš„æ•°é‡ç»æµå»ºæ¨¡è®²åº§ã€‚">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="QRåˆ†è§£" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon-zh-cn.org/qr_decomp.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="æœ¬è¯¾ç¨‹æ˜¯ç”±æ‰˜é©¬æ–¯Â·è¨é‡‘ç‰¹ï¼ˆThomas J. Sargentï¼‰å’Œçº¦ç¿°Â·æ–¯å¡”èƒ¡æ–¯åŸºï¼ˆJohn Stachurskiï¼‰è®¾è®¡å’Œç¼–å†™çš„æ•°é‡ç»æµå»ºæ¨¡è®²åº§ã€‚" />
<meta property="og:site_name" content="Pythonä¸­çº§æ•°é‡ç»æµå­¦" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=qr_decomp>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.1. æ¦‚è¿°</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.2. çŸ©é˜µåˆ†è§£</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3.3. æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a">3.3.1. æ–¹é˜µ<span class="math notranslate nohighlight">\(A\)</span>çš„æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.3.2. <span class="math notranslate nohighlight">\(A\)</span> éæ–¹é˜µ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.4. ä¸€äº›ä»£ç </a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">3.5. ç¤ºä¾‹</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">3.6. ä½¿ç”¨QRåˆ†è§£è®¡ç®—ç‰¹å¾å€¼</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qr-pca">3.7. <span class="math notranslate nohighlight">\(QR\)</span> åˆ†è§£ä¸ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/en/stable/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Pythonä¸­çº§æ•°é‡ç»æµå­¦</a></p>

                        <p class="qe-page__header-subheading">QRåˆ†è§£</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>æ‰˜é©¬æ–¯Â·è¨é‡‘ç‰¹ï¼ˆThomas J. Sargentï¼‰</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>çº¦ç¿°Â·æ–¯å¡”èƒ¡æ–¯åŸºï¼ˆJohn Stachurskiï¼‰</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="qr">
<h1><span class="section-number">3. </span>QRåˆ†è§£<a class="headerlink" href="#qr" title="Link to this heading">#</a></h1>
<section id="id1">
<h2><span class="section-number">3.1. </span>æ¦‚è¿°<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>æœ¬è®²è§£é‡ŠQRåˆ†è§£åŠå…¶ä¸ä»¥ä¸‹å†…å®¹çš„å…³ç³»ï¼š</p>
<ul class="simple">
<li><p>æ­£äº¤æŠ•å½±å’Œæœ€å°äºŒä¹˜æ³•</p></li>
<li><p>æ ¼æ‹‰å§†-æ–½å¯†ç‰¹ï¼ˆGram-Schmidtï¼‰æ­£äº¤åŒ–</p></li>
<li><p>ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</p></li>
</ul>
<p>æˆ‘ä»¬å°†ç¼–å†™ä¸€äº›Pythonä»£ç æ¥å¸®åŠ©å·©å›ºç†è§£ã€‚</p>
</section>
<section id="id2">
<h2><span class="section-number">3.2. </span>çŸ©é˜µåˆ†è§£<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>QRåˆ†è§£ï¼ˆä¹Ÿç§°ä¸ºQRå› å¼åˆ†è§£ï¼‰æ˜¯å°†ä¸€ä¸ªçŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ªæ­£äº¤çŸ©é˜µå’Œä¸€ä¸ªä¸‰è§’çŸ©é˜µçš„ä¹˜ç§¯ã€‚</p>
<p>å¯¹äºä¸€ä¸ªå®çŸ©é˜µ<span class="math notranslate nohighlight">\(A\)</span>ï¼Œå…¶QRåˆ†è§£å½¢å¼ä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
A=QR
\]</div>
<p>å…¶ä¸­ï¼š</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q\)</span>æ˜¯æ­£äº¤çŸ©é˜µï¼ˆæ»¡è¶³<span class="math notranslate nohighlight">\(Q^TQ = I\)</span>ï¼‰</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span>æ˜¯ä¸Šä¸‰è§’çŸ©é˜µ</p></li>
</ul>
<p>æˆ‘ä»¬å°†ä½¿ç”¨<strong>æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–</strong>æ¥è®¡ç®—QRåˆ†è§£</p>
<p>ç”±äºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰æ„æ€ï¼Œæˆ‘ä»¬å°†ç¼–å†™è‡ªå·±çš„Pythonä»£ç æ¥å®Œæˆè¿™é¡¹å·¥ä½œ</p>
</section>
<section id="id3">
<h2><span class="section-number">3.3. </span>æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>æˆ‘ä»¬ä»ä¸€ä¸ª<strong>æ–¹é˜µ</strong><span class="math notranslate nohighlight">\(A\)</span>å¼€å§‹ã€‚</p>
<p>å¦‚æœæ–¹é˜µ<span class="math notranslate nohighlight">\(A\)</span>æ˜¯éå¥‡å¼‚çš„ï¼Œé‚£ä¹ˆ<span class="math notranslate nohighlight">\(QR\)</span>åˆ†è§£æ˜¯å”¯ä¸€çš„ã€‚</p>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„ç®—æ³•ä¹Ÿé€‚ç”¨äºéæ–¹é˜µçš„çŸ©å½¢çŸ©é˜µ<span class="math notranslate nohighlight">\(A\)</span>ã€‚</p>
<p>æˆ‘ä»¬ç¨åä¼šå¤„ç†çŸ©å½¢çŸ©é˜µ<span class="math notranslate nohighlight">\(A\)</span>ã€‚</p>
<section id="a">
<h3><span class="section-number">3.3.1. </span>æ–¹é˜µ<span class="math notranslate nohighlight">\(A\)</span>çš„æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–<a class="headerlink" href="#a" title="Link to this heading">#</a></h3>
<p>è¿™é‡Œæˆ‘ä»¬å¯¹çŸ©é˜µ<span class="math notranslate nohighlight">\(A\)</span>çš„<strong>åˆ—</strong>è¿ç”¨æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œä»¤</p>
<div class="math notranslate nohighlight">
\[
A= \left[ \begin{array}{c|c|c|c} a_1 &amp; a_2 &amp; \cdots &amp; a_n \end{array} \right]
\]</div>
<p>ä»¤<span class="math notranslate nohighlight">\(|| Â· ||\)</span>è¡¨ç¤ºL2èŒƒæ•°ã€‚</p>
<p>æ ¼æ‹‰å§†-æ–½å¯†ç‰¹ç®—æ³•æŒ‰ç‰¹å®šé¡ºåºé‡å¤ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤</p>
<ul class="simple">
<li><p><strong>æ ‡å‡†åŒ–</strong>å‘é‡ä½¿å…¶å…·æœ‰å•ä½èŒƒæ•°</p></li>
<li><p><strong>æ­£äº¤åŒ–</strong>ä¸‹ä¸€ä¸ªå‘é‡</p></li>
</ul>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è®¾<span class="math notranslate nohighlight">\(u_1 = a_1\)</span>ç„¶åè¿›è¡Œ<strong>æ ‡å‡†åŒ–</strong>ï¼š</p>
<div class="math notranslate nohighlight">
\[
u_1=a_1, \ \ \ e_1=\frac{u_1}{||u_1||}
\]</div>
<p>æˆ‘ä»¬å…ˆ<strong>æ­£äº¤åŒ–</strong>è®¡ç®—<span class="math notranslate nohighlight">\(u_2\)</span>ï¼Œç„¶å<strong>æ ‡å‡†åŒ–</strong>å¾—åˆ°<span class="math notranslate nohighlight">\(e_2\)</span>ï¼š</p>
<div class="math notranslate nohighlight">
\[
u_2=a_2-(a_2Â· e_1)e_1, \ \ \  e_2=\frac{u_2}{||u_2||}
\]</div>
<p>æˆ‘ä»¬é‚€è¯·è¯»è€…é€šè¿‡éªŒè¯ <span class="math notranslate nohighlight">\(e_1 \cdot e_2 = 0\)</span> æ¥ç¡®è®¤ <span class="math notranslate nohighlight">\(e_1\)</span> ä¸ <span class="math notranslate nohighlight">\(e_2\)</span> æ­£äº¤ã€‚</p>
<p>æ ¼æ‹‰å§†-æ–½å¯†ç‰¹ç®—æ³•è¿‡ç¨‹è¿­ä»£è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äº <span class="math notranslate nohighlight">\(k= 2, \ldots, n-1\)</span>ï¼Œæˆ‘ä»¬æ„é€ </p>
<div class="math notranslate nohighlight">
\[
u_{k+1}=a_{k+1}-(a_{k+1}Â· e_1)e_1-\cdots-(a_{k+1}Â· e_k)e_k, \ \ \ e_{k+1}=\frac{u_{k+1}}{||u_{k+1}||}
\]</div>
<p>è¿™é‡Œçš„ <span class="math notranslate nohighlight">\((a_j \cdot e_i)\)</span> å¯ä»¥è¢«è§£é‡Šä¸º <span class="math notranslate nohighlight">\(a_j\)</span> åœ¨ <span class="math notranslate nohighlight">\(e_i\)</span> ä¸Šçš„çº¿æ€§æœ€å°äºŒä¹˜<strong>å›å½’ç³»æ•°</strong></p>
<ul class="simple">
<li><p>å®ƒæ˜¯ <span class="math notranslate nohighlight">\(a_j\)</span> å’Œ <span class="math notranslate nohighlight">\(e_i\)</span> çš„å†…ç§¯é™¤ä»¥ <span class="math notranslate nohighlight">\(e_i\)</span> çš„å†…ç§¯ï¼Œå…¶ä¸­ç”±äº<em>æ ‡å‡†åŒ–</em>ï¼Œæˆ‘ä»¬çŸ¥é“ <span class="math notranslate nohighlight">\(e_i \cdot e_i = 1\)</span></p></li>
<li><p>è¿™ä¸ªå›å½’ç³»æ•°å¯ä»¥è§£é‡Šä¸º<strong>åæ–¹å·®</strong>é™¤ä»¥<strong>æ–¹å·®</strong></p></li>
</ul>
<p>å¯ä»¥éªŒè¯</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A= \left[ \begin{array}{c|c|c|c} a_1 &amp; a_2 &amp; \cdots &amp; a_n \end{array} \right]=
\left[ \begin{array}{c|c|c|c} e_1 &amp; e_2 &amp; \cdots &amp; e_n \end{array} \right]
\left[ \begin{matrix} a_1Â·e_1 &amp; a_2Â·e_1 &amp; \cdots &amp; a_nÂ·e_1\\ 0 &amp; a_2Â·e_2 &amp; \cdots &amp; a_nÂ·e_2
\\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; a_nÂ·e_n \end{matrix} \right]
\end{split}\]</div>
<p>å› æ­¤ï¼Œæˆ‘ä»¬æ„é€ äº†çŸ©é˜µåˆ†è§£</p>
<div class="math notranslate nohighlight">
\[ 
A = Q R
\]</div>
<p>å…¶ä¸­</p>
<div class="math notranslate nohighlight">
\[ 
Q = \left[ \begin{array}{c|c|c|c} a_1 &amp; a_2 &amp; \cdots &amp; a_n \end{array} \right]=
\left[ \begin{array}{c|c|c|c} e_1 &amp; e_2 &amp; \cdots &amp; e_n \end{array} \right]
\]</div>
<p>ä¸”</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R = \left[ \begin{matrix} a_1Â·e_1 &amp; a_2Â·e_1 &amp; \cdots &amp; a_nÂ·e_1\\ 0 &amp; a_2Â·e_2 &amp; \cdots &amp; a_nÂ·e_2 \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; a_nÂ·e_n \end{matrix} \right]
\end{split}\]</div>
</section>
<section id="id4">
<h3><span class="section-number">3.3.2. </span><span class="math notranslate nohighlight">\(A\)</span> éæ–¹é˜µ<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>ç°åœ¨å‡è®¾ <span class="math notranslate nohighlight">\(A\)</span> æ˜¯ä¸€ä¸ª <span class="math notranslate nohighlight">\(n \times m\)</span> çŸ©é˜µï¼Œå…¶ä¸­ <span class="math notranslate nohighlight">\(m &gt; n\)</span>ã€‚</p>
<p>é‚£ä¹ˆ <span class="math notranslate nohighlight">\(QR\)</span> åˆ†è§£ä¸º</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A= \left[ \begin{array}{c|c|c|c} a_1 &amp; a_2 &amp; \cdots &amp; a_m \end{array} \right]=\left[ \begin{array}{c|c|c|c} e_1 &amp; e_2 &amp; \cdots &amp; e_n \end{array} \right]
\left[ \begin{matrix} a_1Â·e_1 &amp; a_2Â·e_1 &amp; \cdots &amp; a_nÂ·e_1 &amp; a_{n+1}\cdot e_1 &amp; \cdots &amp; a_{m}\cdot e_1 \\
0 &amp; a_2Â·e_2 &amp; \cdots &amp; a_nÂ·e_2 &amp; a_{n+1}\cdot e_2 &amp; \cdots &amp; a_{m}\cdot e_2 \\ \vdots &amp; \vdots &amp; \ddots &amp; \quad  \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ 0 &amp; 0 &amp; \cdots &amp; a_nÂ·e_n &amp; a_{n+1}\cdot e_n &amp; \cdots &amp; a_{m}\cdot e_n \end{matrix} \right]
\end{split}\]</div>
<p>è¿™æ„å‘³ç€</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
a_1 &amp; = (a_1\cdot e_1) e_1 \cr
a_2 &amp; = (a_2\cdot e_1) e_1 + (a_2\cdot e_2) e_2 \cr
\vdots &amp; \quad \vdots \cr
a_n &amp; = (a_n\cdot e_1) e_1 + (a_n\cdot e_2) e_2 + \cdots + (a_n \cdot e_n) e_n  \cr
a_{n+1} &amp; = (a_{n+1}\cdot e_1) e_1 + (a_{n+1}\cdot e_2) e_2 + \cdots + (a_{n+1}\cdot e_n) e_n  \cr
\vdots &amp; \quad \vdots \cr
a_m &amp; = (a_m\cdot e_1) e_1 + (a_m\cdot e_2) e_2 + \cdots + (a_m \cdot e_n) e_n  \cr
\end{align*}\]</div>
</section>
</section>
<section id="id5">
<h2><span class="section-number">3.4. </span>ä¸€äº›ä»£ç <a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™ä¸€äº›è‡ªåˆ¶çš„Pythonä»£ç ï¼Œé€šè¿‡éƒ¨ç½²ä¸Šè¿°çš„æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–æ¥å®ç°QRåˆ†è§£ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">qr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">QR_Decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># è·å–Açš„å½¢çŠ¶</span>

    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="c1"># åˆå§‹åŒ–çŸ©é˜µQ</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="c1"># åˆå§‹åŒ–çŸ©é˜µu</span>

    <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">Q</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

        <span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">Q</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="c1"># è·å–æ¯ä¸ªuå‘é‡</span>

        <span class="n">Q</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="c1"># è®¡ç®—æ¯ä¸ªeå‘é‡</span>

    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">@</span> <span class="n">Q</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<p>å‰é¢çš„ä»£ç æ²¡é—®é¢˜ï¼Œä½†å¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œæ•´ç†ã€‚</p>
<p>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†åç»­èƒ½å¤Ÿå°†æˆ‘ä»¬è‡ªåˆ¶çš„QRåˆ†è§£ä»£ç ä¸<code class="docutils literal notranslate"><span class="pre">scipy</span></code>åŒ…ä¸­çš„QRåˆ†è§£å‡½æ•°è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>ä¸åŒçš„æ•°å€¼ç®—æ³•äº§ç”Ÿçš„<span class="math notranslate nohighlight">\(Q\)</span>å’Œ<span class="math notranslate nohighlight">\(R\)</span>çŸ©é˜µä¹‹é—´å¯èƒ½å­˜åœ¨ç¬¦å·å·®å¼‚ã€‚</p>
<p>ç”±äºåœ¨è®¡ç®—<span class="math notranslate nohighlight">\(QR\)</span>æ—¶è¿™äº›ç¬¦å·å·®å¼‚ä¼šç›¸äº’æŠµæ¶ˆï¼Œæ‰€ä»¥è¿™äº›éƒ½æ˜¯æœ‰æ•ˆçš„QRåˆ†è§£ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸ºäº†ä½¿æˆ‘ä»¬è‡ªåˆ¶å‡½æ•°å’Œ<code class="docutils literal notranslate"><span class="pre">scipy</span></code>ä¸­QRæ¨¡å—çš„ç»“æœå…·æœ‰å¯æ¯”æ€§ï¼Œè®©æˆ‘ä»¬è¦æ±‚<span class="math notranslate nohighlight">\(Q\)</span>å…·æœ‰æ­£å¯¹è§’çº¿å…ƒç´ ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡é€‚å½“è°ƒæ•´<span class="math notranslate nohighlight">\(Q\)</span>ä¸­åˆ—çš„ç¬¦å·å’Œ<span class="math notranslate nohighlight">\(R\)</span>ä¸­è¡Œçš„ç¬¦å·æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å°†å®šä¹‰ä¸€å¯¹å‡½æ•°æ¥å®Œæˆä¸Šè¿°è¦æ±‚ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">diag_sign</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="s2">&quot;è®¡ç®—çŸ©é˜µAå¯¹è§’çº¿å…ƒç´ çš„ç¬¦å·&quot;</span>

    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">D</span>

<span class="k">def</span><span class="w"> </span><span class="nf">adjust_sign</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    è°ƒæ•´Qä¸­åˆ—çš„ç¬¦å·å’ŒRä¸­è¡Œçš„ç¬¦å·ï¼Œ</span>
<span class="sd">    ä»¥ç¡®ä¿Qçš„æ­£å¯¹è§’çº¿å±æ€§</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">D</span> <span class="o">=</span> <span class="n">diag_sign</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

    <span class="n">Q</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">D</span>
    <span class="n">R</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">@</span> <span class="n">R</span>

    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2><span class="section-number">3.5. </span>ç¤ºä¾‹<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>ç°åœ¨è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 1., 0.],
       [1., 0., 1.],
       [0., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">adjust_sign</span><span class="p">(</span><span class="o">*</span><span class="n">QR_Decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678, -0.40824829, -0.57735027],
       [ 0.70710678,  0.40824829,  0.57735027],
       [ 0.        , -0.81649658,  0.57735027]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.41421356,  0.70710678,  0.70710678],
       [ 0.        , -1.22474487, -0.40824829],
       [ 0.        ,  0.        ,  1.15470054]])
</pre></div>
</div>
</div>
</div>
<p>è®©æˆ‘ä»¬å°†ç»“æœä¸ <code class="docutils literal notranslate"><span class="pre">scipy</span></code> åŒ…äº§ç”Ÿçš„ç»“æœè¿›è¡Œæ¯”è¾ƒ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q_scipy</span><span class="p">,</span> <span class="n">R_scipy</span> <span class="o">=</span> <span class="n">adjust_sign</span><span class="p">(</span><span class="o">*</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;æˆ‘ä»¬çš„ Q: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scipy çš„ Q: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Q_scipy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>æˆ‘ä»¬çš„ Q: 
 [[ 0.70710678 -0.40824829 -0.57735027]
 [ 0.70710678  0.40824829  0.57735027]
 [ 0.         -0.81649658  0.57735027]]


Scipy çš„ Q: 
 [[ 0.70710678 -0.40824829 -0.57735027]
 [ 0.70710678  0.40824829  0.57735027]
 [ 0.         -0.81649658  0.57735027]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;æˆ‘ä»¬çš„ R: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scipy çš„ R: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">R_scipy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>æˆ‘ä»¬çš„ R: 
 [[ 1.41421356  0.70710678  0.70710678]
 [ 0.         -1.22474487 -0.40824829]
 [ 0.          0.          1.15470054]]


Scipy çš„ R: 
 [[ 1.41421356  0.70710678  0.70710678]
 [ 0.         -1.22474487 -0.40824829]
 [ 0.          0.          1.15470054]]
</pre></div>
</div>
</div>
</div>
<p>ä¸Šè¿°ç»“æœç»™æˆ‘ä»¬å¸¦æ¥å¥½æ¶ˆæ¯ï¼Œæˆ‘ä»¬è‡ªåˆ¶çš„å‡½æ•°ä¸scipyäº§ç”Ÿçš„ç»“æœä¸€è‡´ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬å¯¹ä¸€ä¸ªçŸ©å½¢çŸ©é˜µ<span class="math notranslate nohighlight">\(A\)</span>è¿›è¡ŒQRåˆ†è§£ï¼Œè¿™ä¸ªçŸ©é˜µæ˜¯<span class="math notranslate nohighlight">\(n \times m\)</span>çš„ï¼Œå…¶ä¸­<span class="math notranslate nohighlight">\(m &gt; n\)</span>ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">adjust_sign</span><span class="p">(</span><span class="o">*</span><span class="n">QR_Decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[ 0.4472136 , -0.89442719],
        [ 0.89442719,  0.4472136 ]]),
 array([[ 2.23606798,  1.34164079,  9.8386991 ],
        [ 0.        , -2.68328157,  0.4472136 ]]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q_scipy</span><span class="p">,</span> <span class="n">R_scipy</span> <span class="o">=</span> <span class="n">adjust_sign</span><span class="p">(</span><span class="o">*</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">Q_scipy</span><span class="p">,</span> <span class="n">R_scipy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[ 0.4472136 , -0.89442719],
        [ 0.89442719,  0.4472136 ]]),
 array([[ 2.23606798,  1.34164079,  9.8386991 ],
        [ 0.        , -2.68328157,  0.4472136 ]]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">3.6. </span>ä½¿ç”¨QRåˆ†è§£è®¡ç®—ç‰¹å¾å€¼<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>ç°åœ¨ä»‹ç»ä¸€ä¸ªå…³äºQRç®—æ³•çš„æœ‰ç”¨äº‹å®ã€‚</p>
<p>ä»¥ä¸‹åŸºäºQRåˆ†è§£çš„è¿­ä»£å¯ç”¨äºè®¡ç®—<strong>æ–¹é˜µ</strong> <span class="math notranslate nohighlight">\(A\)</span> çš„<strong>ç‰¹å¾å€¼</strong>ã€‚</p>
<p>ç®—æ³•å¦‚ä¸‹ï¼š</p>
<ol class="arabic simple">
<li><p>è®¾ <span class="math notranslate nohighlight">\(A_0 = A\)</span> å¹¶æ„å»º <span class="math notranslate nohighlight">\(A_0 = Q_0 R_0\)</span></p></li>
<li><p>æ„å»º <span class="math notranslate nohighlight">\(A_1 = R_0 Q_0\)</span>ã€‚æ³¨æ„ <span class="math notranslate nohighlight">\(A_1\)</span> ä¸ <span class="math notranslate nohighlight">\(A_0\)</span> ç›¸ä¼¼(æ˜“äºéªŒè¯)ï¼Œå› æ­¤å…·æœ‰ç›¸åŒçš„ç‰¹å¾å€¼ã€‚</p></li>
<li><p>æ„å»º <span class="math notranslate nohighlight">\(A_1 = Q_1 R_1\)</span> (å³æ„å»º <span class="math notranslate nohighlight">\(A_1\)</span> çš„ <span class="math notranslate nohighlight">\(QR\)</span> åˆ†è§£)ã€‚</p></li>
<li><p>æ„å»º <span class="math notranslate nohighlight">\(A_2 = R_1 Q_1\)</span> ç„¶åæ„å»º <span class="math notranslate nohighlight">\(A_2 = Q_2 R_2\)</span>ã€‚</p></li>
<li><p>è¿­ä»£ç›´è‡³æ”¶æ•›ã€‚</p></li>
<li><p>è®¡ç®— <span class="math notranslate nohighlight">\(A\)</span> çš„ç‰¹å¾å€¼ï¼Œå¹¶å°†å…¶ä¸ä»è¯¥è¿‡ç¨‹å¾—åˆ°çš„æé™ <span class="math notranslate nohighlight">\(A_n\)</span> çš„å¯¹è§’çº¿å€¼è¿›è¡Œæ¯”è¾ƒã€‚</p></li>
</ol>
<p><strong>æ³¨æ„ï¼š</strong> è¿™ä¸ªç®—æ³•å®é™…ä¸Šéå¸¸æ¥è¿‘è®¡ç®—ç‰¹å¾å€¼æœ€é«˜æ•ˆçš„æ–¹æ³•ï¼</p>
<p>è®©æˆ‘ä»¬ç¼–å†™ä¸€äº›Pythonä»£ç æ¥å°è¯•è¿™ä¸ªç®—æ³•</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">QR_eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="s2">&quot;ä½¿ç”¨QRåˆ†è§£æ‰¾åˆ°Açš„ç‰¹å¾å€¼ã€‚&quot;</span>

    <span class="n">A_old</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">A_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">diff</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">maxiter</span><span class="p">):</span>
        <span class="n">A_old</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A_new</span>
        <span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QR_Decomposition</span><span class="p">(</span><span class="n">A_old</span><span class="p">)</span>

        <span class="n">A_new</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">R</span> <span class="o">@</span> <span class="n">Q</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A_new</span> <span class="o">-</span> <span class="n">A_old</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A_new</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eigvals</span>
</pre></div>
</div>
</div>
</div>
<p>ç°åœ¨è®©æˆ‘ä»¬è¯•è¯•è¿™æ®µä»£ç ï¼Œå¹¶å°†ç»“æœä¸<code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigvals</span></code>ç»™å‡ºçš„ç»“æœè¿›è¡Œæ¯”è¾ƒ</p>
<p>å¼€å§‹å§</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç”¨ä¸€ä¸ªéšæœºçŸ©é˜µAåšå®éªŒ</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">QR_eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[np.float64(0.06073401207828918),
 np.float64(0.38622566723039486),
 np.float64(1.6790975515256086)]
</pre></div>
</div>
</div>
</div>
<p>ä¸ <code class="docutils literal notranslate"><span class="pre">scipy</span></code> åŒ…è¿›è¡Œæ¯”è¾ƒã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[np.float64(0.06073401207828775),
 np.float64(0.38622566723034124),
 np.float64(1.6790975515256603)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="qr-pca">
<h2><span class="section-number">3.7. </span><span class="math notranslate nohighlight">\(QR\)</span> åˆ†è§£ä¸ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰<a class="headerlink" href="#qr-pca" title="Link to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(QR\)</span> åˆ†è§£ä¸ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ä¹‹é—´å­˜åœ¨ä¸€äº›æœ‰è¶£çš„è”ç³»ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›è”ç³»ï¼š</p>
<ol class="arabic simple">
<li><p>è®¾ <span class="math notranslate nohighlight">\(X'\)</span> æ˜¯ä¸€ä¸ª <span class="math notranslate nohighlight">\(k \times n\)</span> çš„éšæœºçŸ©é˜µï¼Œå…¶ä¸­ç¬¬ <span class="math notranslate nohighlight">\(j\)</span> åˆ—æ˜¯ä» <span class="math notranslate nohighlight">\({\mathcal N}(\mu, \Sigma)\)</span> åˆ†å¸ƒä¸­éšæœºæŠ½å–çš„æ ·æœ¬ï¼Œè¿™é‡Œ <span class="math notranslate nohighlight">\(\mu\)</span> æ˜¯ <span class="math notranslate nohighlight">\(k \times 1\)</span> çš„å‡å€¼å‘é‡ï¼Œ<span class="math notranslate nohighlight">\(\Sigma\)</span> æ˜¯ <span class="math notranslate nohighlight">\(k \times k\)</span> çš„åæ–¹å·®çŸ©é˜µã€‚æˆ‘ä»¬éœ€è¦ <span class="math notranslate nohighlight">\(n &gt; &gt; k\)</span> â€”â€” è¿™æ˜¯ä¸€ä¸ªâ€è®¡é‡ç»æµå­¦â€çš„ä¾‹å­ã€‚</p></li>
<li><p>å°† <span class="math notranslate nohighlight">\(X'\)</span> åˆ†è§£ä¸º <span class="math notranslate nohighlight">\(X' = Q R\)</span>ï¼Œå…¶ä¸­ <span class="math notranslate nohighlight">\(Q\)</span> æ˜¯ <span class="math notranslate nohighlight">\(k \times k\)</span> çŸ©é˜µï¼Œ<span class="math notranslate nohighlight">\(R\)</span> æ˜¯ <span class="math notranslate nohighlight">\(k \times n\)</span> çŸ©é˜µã€‚</p></li>
<li><p>è®¡ç®— <span class="math notranslate nohighlight">\(R R'\)</span> çš„ç‰¹å¾å€¼ï¼Œå³æˆ‘ä»¬å°†è®¡ç®— <span class="math notranslate nohighlight">\(R R' = \tilde P \Lambda \tilde P'\)</span>ã€‚</p></li>
<li><p>æ„é€  <span class="math notranslate nohighlight">\(X' X = Q \tilde P \Lambda \tilde P' Q'\)</span> å¹¶ä¸ç‰¹å¾åˆ†è§£ <span class="math notranslate nohighlight">\(X'X = P \hat \Lambda P'\)</span> è¿›è¡Œæ¯”è¾ƒã€‚</p></li>
<li><p>æˆ‘ä»¬åº”è¯¥ä¼šå‘ç° <span class="math notranslate nohighlight">\(\Lambda = \hat \Lambda\)</span> ä¸” <span class="math notranslate nohighlight">\(P = Q \tilde P\)</span>ã€‚</p></li>
</ol>
<p>è®©æˆ‘ä»¬ç”¨Pythonä»£ç æ¥éªŒè¯æ¨æµ‹5ã€‚</p>
<p>é¦–å…ˆæ¨¡æ‹Ÿä¸€ä¸ªéšæœºçš„ <span class="math notranslate nohighlight">\(\left(n, k\right)\)</span> çŸ©é˜µ <span class="math notranslate nohighlight">\(X\)</span>ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># ç”Ÿæˆä¸€äº›éšæœºçŸ©</span>
<span class="n">ğœ‡</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">Î£</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># X æ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œå…¶ä¸­æ¯ä¸€åˆ—éƒ½éµå¾ªå¤šå…ƒæ­£æ€åˆ†å¸ƒ</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">ğœ‡</span><span class="p">,</span> <span class="n">Î£</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000, 5)
</pre></div>
</div>
</div>
</div>
<p>è®©æˆ‘ä»¬å¯¹<span class="math notranslate nohighlight">\(X^{\prime}\)</span>è¿›è¡ŒQRåˆ†è§£ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">adjust_sign</span><span class="p">(</span><span class="o">*</span><span class="n">QR_Decomposition</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>æ£€æŸ¥ <span class="math notranslate nohighlight">\(Q\)</span> å’Œ <span class="math notranslate nohighlight">\(R\)</span> çš„å½¢çŠ¶ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((5, 5), (5, 1000))
</pre></div>
</div>
</div>
</div>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ„é€  <span class="math notranslate nohighlight">\(R R^{\prime}=\tilde{P} \Lambda \tilde{P}^{\prime}\)</span> å¹¶æ„å»ºç‰¹å¾åˆ†è§£ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RR</span> <span class="o">=</span> <span class="n">R</span> <span class="o">@</span> <span class="n">R</span><span class="o">.</span><span class="n">T</span>

<span class="n">ğœ†</span><span class="p">,</span> <span class="n">P_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="n">Î›</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">ğœ†</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ <span class="math notranslate nohighlight">\(X^{\prime} X=P \hat{\Lambda} P^{\prime}\)</span> è¿›è¡Œåˆ†è§£ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XX</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span>

<span class="n">ğœ†_hat</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
<span class="n">Î›_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">ğœ†_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>æ¯”è¾ƒ <span class="math notranslate nohighlight">\(\Lambda\)</span> å’Œ <span class="math notranslate nohighlight">\(\hat{\Lambda}\)</span> å¯¹è§’çº¿ä¸Šçš„ç‰¹å¾å€¼ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ğœ†</span><span class="p">,</span> <span class="n">ğœ†_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 124.30530773,  328.13157987,  799.98250458,  945.16176078,
        7305.55579384]),
 array([ 124.30530773,  328.13157987,  799.98250458,  945.16176078,
        7305.55579384]))
</pre></div>
</div>
</div>
</div>
<p>è®©æˆ‘ä»¬æ¯”è¾ƒ <span class="math notranslate nohighlight">\(P\)</span> å’Œ <span class="math notranslate nohighlight">\(Q \tilde{P}\)</span>ã€‚</p>
<p>åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ <span class="math notranslate nohighlight">\(P\)</span> å’Œ <span class="math notranslate nohighlight">\(Q\tilde{P}\)</span> çš„åˆ—ä¹‹é—´çš„ç¬¦å·å·®å¼‚ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">QP_tilde</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">P_tilde</span>

<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">P</span> <span class="o">@</span> <span class="n">diag_sign</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">QP_tilde</span> <span class="o">@</span> <span class="n">diag_sign</span><span class="p">(</span><span class="n">QP_tilde</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(1.3572476476042539e-14)
</pre></div>
</div>
</div>
</div>
<p>è®©æˆ‘ä»¬éªŒè¯ <span class="math notranslate nohighlight">\(X^{\prime}X\)</span> å¯ä»¥è¢«åˆ†è§£ä¸º <span class="math notranslate nohighlight">\(Q \tilde{P} \Lambda \tilde{P}^{\prime} Q^{\prime}\)</span>ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">QPÎ›PQ</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">P_tilde</span> <span class="o">@</span> <span class="n">Î›</span> <span class="o">@</span> <span class="n">P_tilde</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Q</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">QPÎ›PQ</span> <span class="o">-</span> <span class="n">XX</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(5.4569682106375694e-12)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  åŸºç¡€å·¥å…·
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. æ–°å† ç—…æ¯’å»ºæ¨¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. çº¿æ€§ä»£æ•°
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   3. QRåˆ†è§£
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. å¾ªç¯çŸ©é˜µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. å¥‡å¼‚å€¼åˆ†è§£
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. å‘é‡è‡ªå›å½’å’ŒåŠ¨æ€æ¨¡æ€åˆ†è§£
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. ä½¿ç”¨ç‰›é¡¿æ³•æ±‚è§£ç»æµæ¨¡å‹
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  åŸºç¡€ç»Ÿè®¡å­¦
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. åŸºç¡€æ¦‚ç‡è®ºä¸çŸ©é˜µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. ä¸€äº›æ¦‚ç‡åˆ†å¸ƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. å¤§æ•°å®šå¾‹ å’Œ ä¸­å¿ƒæé™å®šç†
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. æ¦‚ç‡çš„ä¸¤ç§å«ä¹‰
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. å¤šå…ƒè¶…å‡ ä½•åˆ†å¸ƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. å¤šå…ƒæ­£æ€åˆ†å¸ƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. æ•…éšœæ ‘ä¸ç¡®å®šæ€§
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. äººå·¥ç¥ç»ç½‘ç»œç®€ä»‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. éšæœºåŒ–å›åº”è°ƒæŸ¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. éšæœºå›ç­”çš„æœŸæœ›æ•ˆç”¨
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  è´å¶æ–¯å®šå¾‹
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. éå…±è½­å…ˆéªŒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. AR(1)å‚æ•°çš„åéªŒåˆ†å¸ƒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. é¢„æµ‹ AR(1) è¿‡ç¨‹
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ç»Ÿè®¡ä¸ä¿¡æ¯è®º
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. ç»Ÿè®¡æ•£åº¦åº¦é‡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. ä¼¼ç„¶æ¯”è¿‡ç¨‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process_2.html">
   23. å¼‚è´¨ä¿¡å¿µä¸é‡‘èå¸‚åœº
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. VARæ¨¡å‹çš„ä¼¼ç„¶è¿‡ç¨‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. ä¼¼ç„¶æ¯”è¿‡ç¨‹çš„å‡å€¼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. è®©å¼¥å°”é¡¿Â·å¼—é‡Œå¾·æ›¼å›°æƒ‘çš„é—®é¢˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. ç”¨è´å¶æ–¯æ–¹æ³•è§£å†³å¼—é‡Œå¾·æ›¼å’Œç“¦å°”å¾·é—®é¢˜
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. å¯äº¤æ¢æ€§å’Œè´å¶æ–¯æ›´æ–°
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. ä¼¼ç„¶æ¯”è¿‡ç¨‹å’Œè´å¶æ–¯å­¦ä¹ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. é”™è¯¯æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. è´å¶æ–¯ä¸é¢‘ç‡ä¸»ä¹‰å†³ç­–è§„åˆ™çš„æ¯”è¾ƒ
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  çº¿æ€§è§„åˆ’
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. æœ€ä¼˜ä¼ è¾“
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. å†¯Â·è¯ºä¾æ›¼å¢é•¿æ¨¡å‹ï¼ˆåŠå…¶æ¨å¹¿ï¼‰
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  åŠ¨æ€ç³»ç»Ÿå¯¼è®º
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. æœ‰é™é©¬å°”å¯å¤«é“¾
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. åº“å­˜åŠ¨æ€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   37. è¨ç¼ªå°”æ£®ä¹˜æ•°-åŠ é€Ÿå™¨æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kestenè¿‡ç¨‹ä¸ä¼ä¸šåŠ¨æ€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. è´¢å¯Œåˆ†å¸ƒåŠ¨æ€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. åˆè§å¡å°”æ›¼æ»¤æ³¢å™¨
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. å¡å°”æ›¼æ»¤æ³¢å™¨è¿›é˜¶
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  æœç´¢
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. å·¥ä½œæœå¯» I: McCallæœå¯»æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. å·¥ä½œæœå¯» IIï¼šæœå¯»ä¸ç¦»èŒ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   44. å·¥ä½œæœå¯» III: æ‹Ÿåˆå€¼å‡½æ•°è¿­ä»£
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   45. å·¥ä½œæœå¯» IVï¼šç›¸å…³å·¥èµ„æŠ¥ä»·
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   46. å·¥ä½œæœå¯» Vï¼šèŒä¸šé€‰æ‹©å»ºæ¨¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   47. å·¥ä½œæœå¯» VIï¼šåœ¨èŒæœç´¢
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   48. å·¥ä½œæœå¯» VIIï¼šMcCallåŠ³åŠ¨è€…çš„Qå­¦ä¹ 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. å·¥ä½œæœå¯» VII: å¸¦å­¦ä¹ çš„æœç´¢
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  æ¶ˆè´¹ã€å‚¨è“„ä¸èµ„æœ¬
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   50. Cass-Koopmansæ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   51. Cass-Koopmansç«äº‰å‡è¡¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   52. å¸¦æ‰­æ›²æ€§ç¨æ”¶çš„Cass-Koopmansæ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   53. å¸¦æ‰­æ›²æ€§ç¨æ”¶çš„åŒå›½æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   54. ä»£é™…äº¤å æ¨¡å‹ä¸­çš„è½¬å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   55. åƒè›‹ç³•é—®é¢˜ Iï¼šæœ€ä¼˜å‚¨è“„å¯¼è®º
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   56. åƒè›‹ç³•é—®é¢˜ IIï¼šæ•°å€¼æ–¹æ³•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   57. æœ€ä¼˜å¢é•¿ Iï¼šéšæœºæœ€ä¼˜å¢é•¿æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   58. æœ€ä¼˜å¢é•¿ IIï¼šä½¿ç”¨NumbaåŠ é€Ÿä»£ç 
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   59. æœ€ä¼˜å¢é•¿ IIIï¼šæ—¶é—´è¿­ä»£
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   60. æœ€ä¼˜å¢é•¿ IVï¼šå†…ç”Ÿç½‘æ ¼æ³•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   61. æ”¶å…¥æ³¢åŠ¨é—®é¢˜ Iï¼šåŸºæœ¬æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   62. æ”¶å…¥æ³¢åŠ¨é—®é¢˜ IIï¼šèµ„äº§éšæœºæ”¶ç›Š
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQæ§åˆ¶
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   63. LQæ§åˆ¶ï¼šåŸºç¡€
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   64. LQæ§åˆ¶çš„æ‹‰æ ¼æœ—æ—¥æ–¹æ³•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   65. æ¶ˆé™¤äº¤å‰é¡¹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   66. æ°¸ä¹…æ”¶å…¥æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   67. æ°¸ä¹…æ”¶å…¥ IIï¼šçº¿æ€§äºŒæ¬¡æ–¹æ³•
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   68. é€šè¿‡åº“å­˜å®ç°ç”Ÿäº§å¹³æ»‘
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  å¤šä¸»ä½“æ¨¡å‹
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   69. å°±ä¸šä¸å¤±ä¸šçš„æ¹–æ³Šæ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   70. ç†æ€§é¢„æœŸå‡è¡¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   71. çº¿æ€§ç†æ€§é¢„æœŸæ¨¡å‹ä¸­çš„ç¨³å®šæ€§
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   72. é©¬å°”å¯å¤«å®Œç¾å‡è¡¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   73. ä¸ç¡®å®šæ€§é™·é˜±
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   74. è‰¾äºšåŠ é‡Œæ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak_aiyagari.html">
   75. é•¿å¯¿ã€å¼‚è´¨æ€§ä¸ªä½“ã€ä¸–ä»£äº¤å æ¨¡å‹
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  èµ„äº§å®šä»·ä¸é‡‘è
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   76. èµ„äº§å®šä»·ï¼šæœ‰é™çŠ¶æ€æ¨¡å‹
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   77. å¸¦æœ‰é˜¿ç½—è¯åˆ¸çš„ç«äº‰å‡è¡¡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   78. å¼‚è´¨ä¿¡å¿µä¸æ³¡æ²«
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  æ•°æ®ä¸å®è¯
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   79. ç”¨Pandaså¤„ç†é¢æ¿æ•°æ®
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   80. Pythonçº¿æ€§å›å½’
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   81. æœ€å¤§ä¼¼ç„¶ä¼°è®¡
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  æ‹å–
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   82. ä¸€ä»·å’ŒäºŒä»·æ‹å–
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   83. å¤šç§å•†å“åˆ†é…æœºåˆ¶
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  å…¶ä»–
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   84. æ•…éšœæ’é™¤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   85. å‚è€ƒæ–‡çŒ®
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   86. æ‰§è¡Œç»Ÿè®¡
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/qr_decomp.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/qr_decomp.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/qr_decomp.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.zh-cn.notebooks" data-urlpath="tree/lecture-python.zh-cn.notebooks/qr_decomp.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/qr_decomp.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "qr_decomp";
                const repoURL = "https://github.com/QuantEcon/lecture-python.zh-cn.notebooks";
                const urlPath = "tree/lecture-python.zh-cn.notebooks/qr_decomp.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>