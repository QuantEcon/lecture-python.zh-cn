
<!DOCTYPE html>


<html lang="zh-CN" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>75. 长寿、异质性个体、世代交叠模型 &#8212; Python中级数量经济学</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=a459934d9fea1f60268e46d95e2569a33e1f6ec2" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=946197a6"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=06ebc90d5139b434c2742937a4ef3b185cb93e2f"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ak_aiyagari';</script>
    <link rel="canonical" href="https://python.quantecon-zh-cn.org/ak_aiyagari.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="76. 资产定价：有限状态模型" href="markov_asset.html" />
    <link rel="prev" title="74. 艾亚加里模型" href="aiyagari.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。 />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="长寿、异质性个体、世代交叠模型"/>
<meta name="twitter:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="长寿、异质性个体、世代交叠模型" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon-zh-cn.org/ak_aiyagari.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和编写的数量经济建模讲座。" />
<meta property="og:site_name" content="Python中级数量经济学" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=ak_aiyagari>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">75.1. 概述</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">75.2. 经济环境</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">75.2.1. 人口统计和时间</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">75.2.2. 个体状态变量</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">75.2.3. 劳动供给</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">75.2.4. 初始条件</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">75.3. 生产</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">75.4. 政府</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">75.5. 要素市场活动</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">75.5.1. 特定年龄的劳动供给</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">75.5.2. 资产市场参与</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">75.5.3. 主要特征</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">75.6. 代表性企业的问题</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">75.7. 家庭问题</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">75.8. 人口动态</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">75.9. 均衡</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">75.10. 实现</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">75.11. 计算稳态</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">75.12. 转换动态</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">75.13. 实验1：即时减税</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">75.14. 实验2：预先宣布的减税</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/en/stable/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Python中级数量经济学</a></p>

                        <p class="qe-page__header-subheading">长寿、异质性个体、世代交叠模型</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>托马斯·萨金特（Thomas J. Sargent）</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>约翰·斯塔胡斯基（John Stachurski）</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">75. </span>长寿、异质性个体、世代交叠模型<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>除了Anaconda中已有的库之外，本讲座还需要以下库</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>jax
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2><span class="section-number">75.1. </span>概述<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>本讲座描述了一个具有以下特征的世代交叠模型：</p>
<ul class="simple">
<li><p>不完全市场的竞争均衡决定价格和数量</p></li>
<li><p>如 <span id="id3">[<a class="reference internal" href="zreferences.html#id268" title="Alan J Auerbach and Laurence J Kotlikoff. Dynamic fiscal policy. Cambridge University Press, Cambridge, 1987.">Auerbach and Kotlikoff, 1987</a>]</span> 所述，个体存活多个时期</p></li>
<li><p>如 <span id="id4">[<a class="reference internal" href="zreferences.html#id149" title="S Rao Aiyagari. Uninsured Idiosyncratic Risk and Aggregate Saving. The Quarterly Journal of Economics, 109(3):659–684, 1994.">Aiyagari, 1994</a>]</span> 所述，个体受到无法完全投保的特殊劳动生产率冲击</p></li>
<li><p>如 <span id="id5">[<a class="reference internal" href="zreferences.html#id268" title="Alan J Auerbach and Laurence J Kotlikoff. Dynamic fiscal policy. Cambridge University Press, Cambridge, 1987.">Auerbach and Kotlikoff, 1987</a>]</span> 第2章和 <a class="reference internal" href="ak2.html"><span class="doc">Transitions in an Overlapping Generations Model</span></a> 所述，政府财政政策工具包括税率、债务和转移支付</p></li>
<li><p>在其他均衡要素中，竞争均衡决定了异质性个体消费、劳动收入和储蓄的横截面密度序列</p></li>
</ul>
<p>我们使用该模型研究：</p>
<ul class="simple">
<li><p>财政政策如何影响不同世代</p></li>
<li><p>市场不完全性如何促进预防性储蓄</p></li>
<li><p>生命周期储蓄和缓冲储蓄动机如何相互作用</p></li>
<li><p>财政政策如何在世代间和世代内重新分配资源</p></li>
</ul>
<p>作为本讲座的先决条件，我们推荐两个 quantecon 讲座：</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://python-advanced.quantecon.org/discrete_dp.html" title="（在 Project name not set）"><span>Discrete State Dynamic Programming</span></a></p></li>
<li><p><a class="reference internal" href="ak2.html"><span class="doc">代际交叠模型中的转型</span></a></p></li>
</ol>
<p>以及可选阅读材料 <a class="reference internal" href="aiyagari.html"><span class="doc">艾亚加里模型</span></a></p>
<p>像往常一样，让我们先导入一些 Python 模块</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jsp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">jax.scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jsp</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;jax&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2><span class="section-number">75.2. </span>经济环境<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>我们首先介绍我们所处的经济环境。</p>
<section id="id7">
<h3><span class="section-number">75.2.1. </span>人口统计和时间<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>我们在离散时间中工作,用 <span class="math notranslate nohighlight">\(t = 0, 1, 2, ...\)</span> 表示。</p>
<p>每个个体存活 <span class="math notranslate nohighlight">\(J = 50\)</span> 个时期,不存在死亡风险。</p>
<p>我们用 <span class="math notranslate nohighlight">\(j = 0, 1, ..., 49\)</span> 表示年龄,人口规模固定在 <span class="math notranslate nohighlight">\(1/J\)</span>。</p>
</section>
<section id="id8">
<h3><span class="section-number">75.2.2. </span>个体状态变量<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>在时间 <span class="math notranslate nohighlight">\(t\)</span> 时,年龄为 <span class="math notranslate nohighlight">\(j\)</span> 的个体 <span class="math notranslate nohighlight">\(i\)</span> 由两个状态变量表征:资产持有量 <span class="math notranslate nohighlight">\(a_{i,j,t}\)</span> 和特质劳动生产率 <span class="math notranslate nohighlight">\(\gamma_{i,j,t}\)</span>。</p>
<p>特质劳动生产率过程遵循一个两状态马尔可夫链,取值为 <span class="math notranslate nohighlight">\(\gamma_l\)</span> 和 <span class="math notranslate nohighlight">\(\gamma_h\)</span>,转移矩阵为 <span class="math notranslate nohighlight">\(\Pi\)</span>。</p>
<p>新生个体在这些生产率状态上的初始分布为 <span class="math notranslate nohighlight">\(\pi = [0.5, 0.5]\)</span>。</p>
</section>
<section id="id9">
<h3><span class="section-number">75.2.3. </span>劳动供给<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>生产率为 <span class="math notranslate nohighlight">\(\gamma_{i,j,t}\)</span> 的个体提供 <span class="math notranslate nohighlight">\(l(j)\gamma_{i,j,t}\)</span> 单位的有效劳动。</p>
<p><span class="math notranslate nohighlight">\(l(j)\)</span> 是一个确定性的年龄特定劳动效率单位曲线。</p>
<p>个体的有效劳动供给取决于生命周期效率曲线和特质随机过程。</p>
</section>
<section id="id10">
<h3><span class="section-number">75.2.4. </span>初始条件<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>新生个体的初始资产为零 <span class="math notranslate nohighlight">\(a_{i,0,t} = 0\)</span>。</p>
<p>初始特质生产率从分布 <span class="math notranslate nohighlight">\(\pi\)</span> 中抽取。</p>
<p>个体不留遗产,终期价值函数为 <span class="math notranslate nohighlight">\(V_J(a) = 0\)</span>。</p>
</section>
</section>
<section id="id11">
<h2><span class="section-number">75.3. </span>生产<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>代表性企业采用规模报酬不变的柯布-道格拉斯生产函数:</p>
<div class="math notranslate nohighlight">
\[Y_t = Z_t K_t^\alpha L_t^{1-\alpha}\]</div>
<p>其中:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K_t\)</span> 是总资本</p></li>
<li><p><span class="math notranslate nohighlight">\(L_t\)</span> 是总劳动效率单位</p></li>
<li><p><span class="math notranslate nohighlight">\(Z_t\)</span> 是全要素生产率</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> 是资本份额</p></li>
</ul>
</section>
<section id="id12">
<h2><span class="section-number">75.4. </span>政府<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<p>政府实行包括债务、税收、转移支付和政府支出的财政政策。</p>
<p>政府发行一期债务 <span class="math notranslate nohighlight">\(D_t\)</span> 来为其运营提供资金，并通过对劳动和资本收入征收统一税率 <span class="math notranslate nohighlight">\(\tau_t\)</span> 来收取收入。</p>
<p>政府还实施针对不同年龄组的定额税收或转移支付 <span class="math notranslate nohighlight">\(\delta_{j,t}\)</span>，可以在不同年龄组之间重新分配资源。</p>
<p>此外，政府还进行公共物品和服务的政府采购 <span class="math notranslate nohighlight">\(G_t\)</span>。</p>
<p>政府在时间 <span class="math notranslate nohighlight">\(t\)</span> 的预算约束是</p>
<div class="math notranslate nohighlight">
\[
D_{t+1} - D_t = r_t D_t + G_t - T_t
\]</div>
<p>其中总税收 <span class="math notranslate nohighlight">\(T_t\)</span> 满足</p>
<div class="math notranslate nohighlight">
\[
T_t = \tau_t w_t L_t + \tau_t r_t(D_t + K_t) + \sum_j \delta_{j,t}
\]</div>
</section>
<section id="id13">
<h2><span class="section-number">75.5. </span>要素市场活动<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>在每个时间 <span class="math notranslate nohighlight">\(t \geq 0\)</span>，个体供应劳动和资本。</p>
<section id="id14">
<h3><span class="section-number">75.5.1. </span>特定年龄的劳动供给<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>年龄为 <span class="math notranslate nohighlight">\(j \in \{0,1,...,J-1\}\)</span> 的个体根据以下因素供应劳动：</p>
<ul class="simple">
<li><p>其确定性的年龄效率曲线 <span class="math notranslate nohighlight">\(l(j)\)</span></p></li>
<li><p>其当前特质生产率冲击 <span class="math notranslate nohighlight">\(\gamma_{i,j,t}\)</span></p></li>
</ul>
<p>每个个体供应 <span class="math notranslate nohighlight">\(l(j)\gamma_{i,j,t}\)</span> 个有效劳动单位，并按每个有效单位获得竞争性工资 <span class="math notranslate nohighlight">\(w_t\)</span>，同时需缴纳统一税率 <span class="math notranslate nohighlight">\(\tau_t\)</span> 的劳动收入税。</p>
</section>
<section id="id15">
<h3><span class="section-number">75.5.2. </span>资产市场参与<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p>总结资产市场活动，所有年龄为 <span class="math notranslate nohighlight">\(j \in \{0,1,...,J-1\}\)</span> 的个体都可以：</p>
<ul class="simple">
<li><p>持有资产 <span class="math notranslate nohighlight">\(a_{i,j,t}\)</span>（受借贷约束）</p></li>
<li><p>在储蓄上获得无风险的单期回报率 <span class="math notranslate nohighlight">\(r_t\)</span></p></li>
<li><p>按统一税率 <span class="math notranslate nohighlight">\(\tau_t\)</span> 缴纳资本所得税</p></li>
<li><p>获得或支付与年龄相关的转移支付 <span class="math notranslate nohighlight">\(\delta_{j,t}\)</span></p></li>
</ul>
</section>
<section id="id16">
<h3><span class="section-number">75.5.3. </span>主要特征<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<p><em>生命周期模式</em>影响不同年龄的经济行为：</p>
<ul class="simple">
<li><p>劳动生产率根据年龄曲线 <span class="math notranslate nohighlight">\(l(j)\)</span> 系统性变化，而资产持有量通常遵循工作年龄段积累、退休年龄段消耗的生命周期模式。</p></li>
<li><p>特定年龄的财政转移支付 <span class="math notranslate nohighlight">\(\delta_{j,t}\)</span> 在代际间重新分配资源。</p></li>
</ul>
<p><em>同期群组内部异质性</em>导致同龄人之间的差异：</p>
<ul class="simple">
<li><p>同龄人因特异性生产率冲击的不同历史、当前生产率 <span class="math notranslate nohighlight">\(\gamma_{i,j,t}\)</span>，以及由此产生的劳动收入和金融财富的差异，而在资产持有量 <span class="math notranslate nohighlight">\(a_{i,j,t}\)</span> 上存在差异。</p></li>
</ul>
<p><em>跨期群组互动</em>通过市场聚合决定均衡结果：</p>
<ul class="simple">
<li><p>所有群组共同参与要素市场，所有群组的资产供给决定总资本，所有群组的有效劳动供给决定总劳动。</p></li>
<li><p>均衡价格反映生命周期和再分配的双重力量。</p></li>
</ul>
</section>
</section>
<section id="id17">
<h2><span class="section-number">75.6. </span>代表性企业的问题<a class="headerlink" href="#id17" title="Link to this heading">#</a></h2>
<p>代表性企业选择资本和有效劳动以最大化利润</p>
<div class="math notranslate nohighlight">
\[
\max_{K,L} Z_t K_t^\alpha L_t^{1-\alpha} - r_t K_t - w_t L_t
\]</div>
<p>一阶必要条件意味着</p>
<div class="math notranslate nohighlight">
\[
w_t = (1-\alpha)Z_t(K_t/L_t)^\alpha
\]</div>
<p>和</p>
<div class="math notranslate nohighlight">
\[
r_t = \alpha Z_t(K_t/L_t)^{\alpha-1}
\]</div>
</section>
<section id="id18">
<h2><span class="section-number">75.7. </span>家庭问题<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
<p>家庭的价值函数满足贝尔曼方程</p>
<div class="math notranslate nohighlight">
\[
V_{j,t}(a, \gamma) = \max_{c,a'} \{u(c) + \beta\mathbb{E}[V_{j+1,t+1}(a', \gamma')]\}
\]</div>
<p>其中最大化受约束于</p>
<div class="math notranslate nohighlight">
\[
c + a' = (1 + r_t(1-\tau_t))a + (1-\tau_t)w_t l(j)\gamma - \delta_{j,t}
\]</div>
<div class="math notranslate nohighlight">
\[
c \geq 0
\]</div>
<p>以及终端条件
<span class="math notranslate nohighlight">\(V_{J,t}(a, \gamma) = 0\)</span></p>
</section>
<section id="id19">
<h2><span class="section-number">75.8. </span>人口动态<a class="headerlink" href="#id19" title="Link to this heading">#</a></h2>
<p>资产持有量和特质劳动生产率的联合概率密度函数<span class="math notranslate nohighlight">\(\mu_{j,t}(a,\gamma)\)</span>按如下方式演化：</p>
<ul class="simple">
<li><p>对于新生人口<span class="math notranslate nohighlight">\((j=0)\)</span>：</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\mu_{0,t+1}(a',\gamma') =\begin{cases}
\pi(\gamma') &amp;\text{ 若 }a'=0\text{, }\\
		    0, &amp; \text{其他情况}
		 \end{cases}
\end{split}\]</div>
<ul>
<li><p>对于其他群组：</p>
<div class="math notranslate nohighlight">
\[
   \mu_{j+1,t+1}(a',\gamma') = \int {\bf 1}_{\sigma_{j,t}(a,\gamma)=a'}\Pi(\gamma,\gamma')\mu_{j,t}(a,\gamma)d(a,\gamma)
   \]</div>
</li>
</ul>
<p>其中<span class="math notranslate nohighlight">\(\sigma_{j,t}(a,\gamma)\)</span>是最优储蓄策略函数。</p>
</section>
<section id="id20">
<h2><span class="section-number">75.9. </span>均衡<a class="headerlink" href="#id20" title="Link to this heading">#</a></h2>
<p>均衡包括：</p>
<ul class="simple">
<li><p>价值函数<span class="math notranslate nohighlight">\(V_{j,t}\)</span></p></li>
<li><p>策略函数<span class="math notranslate nohighlight">\(\sigma_{j,t}\)</span></p></li>
<li><p>联合概率分布<span class="math notranslate nohighlight">\(\mu_{j,t}\)</span></p></li>
<li><p>价格<span class="math notranslate nohighlight">\(r_t, w_t\)</span></p></li>
<li><p>政府政策<span class="math notranslate nohighlight">\(\tau_t, D_t, \delta_{j,t}, G_t\)</span></p></li>
</ul>
<p>满足以下条件：</p>
<ul class="simple">
<li><p>在给定价格和政府政策的情况下，价值函数和策略函数解决家庭问题</p></li>
<li><p>在给定价格的情况下，代表性企业实现利润最大化</p></li>
<li><p>政府预算约束得到满足</p></li>
<li><p>市场出清：</p>
<ul>
<li><p>资产市场：<span class="math notranslate nohighlight">\(K_t = \sum_j \int a \mu_{j,t}(a,\gamma)d(a,\gamma) - D_t\)</span></p></li>
<li><p>劳动力市场：<span class="math notranslate nohighlight">\(L_t = \sum_j \int l(j)\gamma \mu_{j,t}(a,\gamma)d(a,\gamma)\)</span></p></li>
</ul>
</li>
</ul>
<p>相对于<a class="reference internal" href="ak2.html"><span class="doc">Transitions in an Overlapping Generations Model</span></a>中提出的模型，本模型增加了：</p>
<ul class="simple">
<li><p>由生产率冲击导致的代内异质性</p></li>
<li><p>预防性储蓄动机</p></li>
<li><p>更多的再分配效应</p></li>
<li><p>更复杂的转型动态</p></li>
</ul>
</section>
<section id="id21">
<h2><span class="section-number">75.10. </span>实现<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<p>使用<a class="reference external" href="https://python-advanced.quantecon.org/discrete_dp.html" title="（在 Project name not set）"><span>Discrete State Dynamic Programming</span></a>中的工具，我们通过将值函数迭代与均衡价格确定相结合来求解我们的模型。</p>
<p>一个合理的方法是在寻找市场出清价格的外循环中嵌套一个离散动态规划求解器。</p>
<p>对于候选序列的利率<span class="math notranslate nohighlight">\(r_t\)</span>和工资<span class="math notranslate nohighlight">\(w_t\)</span>，我们可以使用值函数迭代或策略迭代来求解个体家庭的动态规划问题，从而获得最优策略函数。</p>
<p>然后我们推导出每个年龄群体的资产持有量和特质劳动效率单位的相关平稳联合概率分布。</p>
<p>这将给我们提供总资本供给（来自家庭储蓄）和劳动力供给（来自年龄效率曲线和生产率冲击）。</p>
<p>然后我们可以将这些与企业的资本和劳动力需求进行比较，计算要素市场供给和需求之间的偏差，然后更新价格猜测，直到找到市场出清价格。</p>
<p>为了构建转型动态，我们可以通过使用_向后归纳法_计算价值函数和政策函数，以及使用_向前迭代法_计算主体在各状态之间的分布，来计算时变价格序列：</p>
<ol class="arabic simple">
<li><p>外循环（市场出清）</p>
<ul class="simple">
<li><p>猜测初始价格（<span class="math notranslate nohighlight">\(r_t, w_t\)</span>）</p></li>
<li><p>迭代直到资产和劳动力市场出清</p></li>
<li><p>使用企业的一阶必要条件来更新价格</p></li>
</ul>
</li>
<li><p>内循环（个体动态规划）</p>
<ul class="simple">
<li><p>对每个年龄群组：</p>
<ul>
<li><p>离散化资产和生产率状态空间</p></li>
<li><p>使用价值函数迭代或政策迭代</p></li>
<li><p>求解最优储蓄政策</p></li>
<li><p>计算稳态分布</p></li>
</ul>
</li>
</ul>
</li>
<li><p>聚合</p>
<ul class="simple">
<li><p>在每个群组内对个体状态求和</p></li>
<li><p>跨群组求和得到</p>
<ul>
<li><p>总资本供给，和</p></li>
<li><p>总有效劳动力供给</p></li>
</ul>
</li>
<li><p>考虑人口权重 <span class="math notranslate nohighlight">\(1/J\)</span></p></li>
</ul>
</li>
<li><p>转型动态</p>
<ul class="simple">
<li><p>向后归纳：</p>
<ul>
<li><p>从最终稳态开始</p></li>
<li><p>求解价值函数序列</p></li>
</ul>
</li>
<li><p>向前迭代：</p>
<ul>
<li><p>从初始分布开始</p></li>
<li><p>追踪群组分布随时间变化</p></li>
</ul>
</li>
<li><p>每期市场出清：</p>
<ul>
<li><p>求解价格序列</p></li>
<li><p>更新直到所有市场在所有期都出清</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p>我们通过定义描述偏好、企业和政府预算约束的辅助函数来开始编码。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ϕ</span><span class="p">,</span> <span class="n">k_bar</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">V_bar</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="s2">&quot;根据资产持有量确定的终端价值函数。&quot;</span>

    <span class="k">return</span> <span class="o">-</span> <span class="n">ϕ</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">k_bar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ν</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">u</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="s2">&quot;消费带来的效用。&quot;</span>

    <span class="k">return</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ν</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ν</span><span class="p">)</span>

<span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">l3</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0008</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">l</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
    <span class="s2">&quot;年龄相关的工资曲线。&quot;</span>

    <span class="k">return</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">l3</span> <span class="o">*</span> <span class="n">j</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>让我们定义一个包含控制生产技术参数的<code class="docutils literal notranslate"><span class="pre">Firm</span></code>命名元组。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Firm</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Firm&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;α&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_firm</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">Firm</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="n">α</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">firm</span> <span class="o">=</span> <span class="n">create_firm</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>以下辅助函数将从代表性企业的一阶必要条件中得出的要素投入（<span class="math notranslate nohighlight">\(K, L\)</span>）和要素价格（<span class="math notranslate nohighlight">\(w, r\)</span>）联系起来。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">KL_to_r</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">):</span>

    <span class="n">α</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">firm</span>

    <span class="k">return</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">α</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">α</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">KL_to_w</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">):</span>

    <span class="n">α</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">firm</span>

    <span class="k">return</span> <span class="n">Z</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">**</span> <span class="n">α</span>
</pre></div>
</div>
</div>
</div>
<p>我们使用函数<code class="docutils literal notranslate"><span class="pre">find_τ</span></code>来寻找能够平衡政府预算约束的统一税率，这个税率取决于其他政策变量，包括债务水平、政府支出和转移支付。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_τ</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">aggs</span><span class="p">):</span>

    <span class="n">D</span><span class="p">,</span> <span class="n">D_next</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="n">policy</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">price</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">aggs</span>

    <span class="n">num</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="n">G</span> <span class="o">-</span> <span class="n">D_next</span> <span class="o">+</span> <span class="n">D</span> <span class="o">-</span> <span class="n">δ</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">K</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">num</span> <span class="o">/</span> <span class="n">denom</span>
</pre></div>
</div>
</div>
</div>
<p>我们使用命名元组<code class="docutils literal notranslate"><span class="pre">Household</span></code>来存储表征家庭问题的参数。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Household</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Household&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;j_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;a_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;γ_grid&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;Π&quot;</span><span class="p">,</span> <span class="s2">&quot;β&quot;</span><span class="p">,</span> <span class="s2">&quot;init_μ&quot;</span><span class="p">,</span> <span class="s2">&quot;VJ&quot;</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_household</span><span class="p">(</span>
        <span class="n">a_min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">Π</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
        <span class="n">γ_grid</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
        <span class="n">β</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mi">50</span>
    <span class="p">):</span>

    <span class="n">j_grid</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

    <span class="n">a_grid</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">a_size</span><span class="p">)</span>

    <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="p">(</span><span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">))</span>
    <span class="n">γ_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">γ_grid</span><span class="p">)</span>

    <span class="c1"># 新生人口的分布</span>
    <span class="n">init_μ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">a_size</span> <span class="o">*</span> <span class="n">γ_size</span><span class="p">))</span>

    <span class="c1"># 新生者的初始资产为零</span>
    <span class="c1"># 且γ的概率相等</span>
    <span class="n">init_μ</span> <span class="o">=</span> <span class="n">init_μ</span><span class="o">.</span><span class="n">at</span><span class="p">[:</span><span class="n">γ_size</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">γ_size</span><span class="p">)</span>

    <span class="c1"># 终端值V_bar(a)</span>
    <span class="n">VJ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">a_size</span> <span class="o">*</span> <span class="n">γ_size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a_size</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a_grid</span><span class="p">[</span><span class="n">a_i</span><span class="p">]</span>
        <span class="n">VJ</span> <span class="o">=</span> <span class="n">VJ</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">a_i</span><span class="o">*</span><span class="n">γ_size</span><span class="p">:(</span><span class="n">a_i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">γ_size</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">V_bar</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Household</span><span class="p">(</span><span class="n">j_grid</span><span class="o">=</span><span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="o">=</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="o">=</span><span class="n">γ_grid</span><span class="p">,</span>
                     <span class="n">Π</span><span class="o">=</span><span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="o">=</span><span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span><span class="o">=</span><span class="n">VJ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hh</span> <span class="o">=</span> <span class="n">create_household</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>我们应用离散状态动态规划工具。</p>
<p>初始步骤包括为我们的离散化贝尔曼方程准备奖励矩阵 <span class="math notranslate nohighlight">\(R\)</span> 和转移矩阵 <span class="math notranslate nohighlight">\(Q\)</span>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">populate_Q</span><span class="p">(</span><span class="n">household</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_action</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">Q</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">block_diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Π</span><span class="p">]</span><span class="o">*</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_state</span><span class="p">,</span> <span class="n">num_action</span><span class="p">,</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="k">return</span> <span class="n">Q</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">populate_R</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">household</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_action</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a_grid</span><span class="p">,</span> <span class="p">(</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">γ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">γ_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ</span><span class="p">))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">l</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">num_state</span><span class="p">,</span> <span class="n">num_action</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id22">
<h2><span class="section-number">75.11. </span>计算稳态<a class="headerlink" href="#id22" title="Link to this heading">#</a></h2>
<p>我们首先计算一个稳态。</p>
<p>给定价格和税收的猜测值，我们可以使用反向归纳法来求解所有年龄段的价值函数以及最优消费和储蓄策略。</p>
<p>函数<code class="docutils literal notranslate"><span class="pre">backwards_opt</span></code>通过反向应用离散化的贝尔曼算子来求解最优值。</p>
<p>我们使用<code class="docutils literal notranslate"><span class="pre">jax.lax.scan</span></code>来高效地进行顺序和递归计算。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">backwards_opt</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">taxes</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">prices</span>
    <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="n">taxes</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_action</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bellman_operator_j</span><span class="p">(</span><span class="n">V_next</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="s2">&quot;在给定Vj+1的情况下，求解年龄j时的家庭优化问题&quot;</span>

        <span class="n">Rj</span> <span class="o">=</span> <span class="n">populate_R</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">household</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">Rj</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V_next</span><span class="p">)</span>
        <span class="n">σ_j</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">V_j</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_state</span><span class="p">),</span> <span class="n">σ_j</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">V_j</span><span class="p">,</span> <span class="p">(</span><span class="n">V_j</span><span class="p">,</span> <span class="n">σ_j</span><span class="p">)</span>

    <span class="n">js</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">init_V</span> <span class="o">=</span> <span class="n">VJ</span>

    <span class="c1"># 从年龄J迭代到1</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">bellman_operator_j</span><span class="p">,</span> <span class="n">init_V</span><span class="p">,</span> <span class="n">js</span><span class="p">)</span>
    <span class="n">V</span><span class="p">,</span> <span class="n">σ</span> <span class="o">=</span> <span class="n">outputs</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">V</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">σ</span> <span class="o">=</span> <span class="n">σ</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">σ</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">τ</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">populate_Q</span><span class="p">(</span><span class="n">hh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="p">,</span> <span class="n">σ</span> <span class="o">=</span> <span class="n">backwards_opt</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">],</span> <span class="p">[</span><span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">],</span> <span class="n">hh</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>让我们用 <code class="docutils literal notranslate"><span class="pre">block_until_ready()</span></code> 来计时，以确保所有 JAX 运算都已完成</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> backwards_opt([r, w], [τ, δ], hh, Q)[0].block_until_ready();
</pre></div>
</div>
</div>
</div>
<p>从每个群组的最优消费和储蓄选择出发，我们可以计算出稳态下资产水平和特质生产率水平的联合概率分布。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">popu_dist</span><span class="p">(</span><span class="n">σ</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">J</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_state</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_popu_j</span><span class="p">(</span><span class="n">μ_j</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="s2">&quot;更新从年龄j到j+1的人口分布&quot;</span>

        <span class="n">Qσ</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_state</span><span class="p">),</span> <span class="n">σ</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
        <span class="n">μ_next</span> <span class="o">=</span> <span class="n">μ_j</span> <span class="o">@</span> <span class="n">Qσ</span>

        <span class="k">return</span> <span class="n">μ_next</span><span class="p">,</span> <span class="n">μ_next</span>

    <span class="n">js</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># 从年龄1迭代到J</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">μ</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">update_popu_j</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">js</span><span class="p">)</span>
    <span class="n">μ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">init_μ</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">μ</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">μ</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">μ</span> <span class="o">=</span> <span class="n">popu_dist</span><span class="p">(</span><span class="n">σ</span><span class="p">,</span> <span class="n">hh</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>让我们计时计算过程</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> popu_dist(σ, hh, Q)[0].block_until_ready();
</pre></div>
</div>
</div>
</div>
<p>下面我们绘制每个年龄组的储蓄边际分布。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">49</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">μ</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;j=</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;marginal distribution over a, $\sum_\gamma \mu_j(a, \gamma)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>这些边际分布确认新进入经济体的个体没有任何资产持有。</p>
<ul class="simple">
<li><p>蓝色的 <span class="math notranslate nohighlight">\(j=0\)</span> 分布仅在 <span class="math notranslate nohighlight">\(a=0\)</span> 处有质量。</p></li>
</ul>
<p>随着个体年龄增长，他们最初会逐渐积累资产。</p>
<ul class="simple">
<li><p>橙色的 <span class="math notranslate nohighlight">\(j=5\)</span> 分布在正但较低的资产水平上有正质量</p></li>
<li><p>绿色的 <span class="math notranslate nohighlight">\(j=20\)</span> 分布在更广范围的资产水平上有正质量</p></li>
<li><p>红色的 <span class="math notranslate nohighlight">\(j=45\)</span> 分布范围更宽</p></li>
</ul>
<p>在较晚年龄，他们会逐渐减少其资产持有。</p>
<ul class="simple">
<li><p>紫色的 <span class="math notranslate nohighlight">\(j=49\)</span> 分布说明了这一点</p></li>
</ul>
<p>在生命末期，他们将耗尽所有资产。</p>
<p>让我们现在看看产生前述不同年龄资产边际分布的年龄特定最优储蓄政策。</p>
<p>我们将用以下Python代码绘制一些储蓄函数。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">σ_reshaped</span> <span class="o">=</span> <span class="n">σ</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">j_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;j=</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">49</span><span class="p">]]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_reshaped</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$a_</span><span class="si">{j}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$a^*_{j+1}$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">j_labels</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;45 degree line&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Optimal saving policy, low $\gamma$&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_reshaped</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$a_</span><span class="si">{j}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$a^*_{j+1}$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">j_labels</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;45 degree line&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Optimal saving policy, high $\gamma$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>从隐含的平稳人口分布中，我们可以计算总劳动供给 <span class="math notranslate nohighlight">\(L\)</span> 和私人储蓄 <span class="math notranslate nohighlight">\(A\)</span>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_aggregates</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">household</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">J</span><span class="p">,</span> <span class="n">a_size</span><span class="p">,</span> <span class="n">γ_size</span> <span class="o">=</span> <span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">μ</span> <span class="o">=</span> <span class="n">μ</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="c1"># 计算私人储蓄</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">a_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">μ</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">J</span>

    <span class="n">γ</span> <span class="o">=</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">γ_size</span><span class="p">))</span>
    <span class="n">lj</span> <span class="o">=</span> <span class="n">l</span><span class="p">(</span><span class="n">j_grid</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">*</span> <span class="n">μ</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">J</span>

    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">L</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">compute_aggregates</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">hh</span><span class="p">)</span>
<span class="n">A</span><span class="p">,</span> <span class="n">L</span>
</pre></div>
</div>
</div>
</div>
<p>该经济体中的资本存量等于<span class="math notranslate nohighlight">\(A-D\)</span>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">D</span>
</pre></div>
</div>
</div>
</div>
<p>企业的最优条件意味着利率 <span class="math notranslate nohighlight">\(r\)</span> 和工资率 <span class="math notranslate nohighlight">\(w\)</span>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KL_to_r</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">),</span> <span class="n">KL_to_w</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>隐含价格<span class="math notranslate nohighlight">\((r,w)\)</span>与我们的猜测不同，所以我们必须更新猜测并迭代直到找到一个不动点。</p>
<p>这是我们的外层循环。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_ss</span><span class="p">(</span><span class="n">household</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">pol_target</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="n">pol_target</span>

    <span class="c1"># 价格的初始猜测</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.</span>

    <span class="c1"># τ的初始猜测</span>
    <span class="n">τ</span> <span class="o">=</span> <span class="mf">0.15</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cond_fn</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="s2">&quot;收敛标准。&quot;</span>

        <span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">r_old</span><span class="p">,</span> <span class="n">w_old</span> <span class="o">=</span> <span class="n">state</span>

        <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_old</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">w_old</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">tol</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">body_fn</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="s2">&quot;迭代的主体部分。&quot;</span>

        <span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">r_old</span><span class="p">,</span> <span class="n">w_old</span> <span class="o">=</span> <span class="n">state</span>
        <span class="n">r_old</span><span class="p">,</span> <span class="n">w_old</span><span class="p">,</span> <span class="n">τ_old</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span>

        <span class="c1"># 家庭最优决策和价值</span>
        <span class="n">V</span><span class="p">,</span> <span class="n">σ</span> <span class="o">=</span> <span class="n">backwards_opt</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">],</span> <span class="p">[</span><span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">],</span> <span class="n">hh</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="c1"># 计算稳态分布</span>
        <span class="n">μ</span> <span class="o">=</span> <span class="n">popu_dist</span><span class="p">(</span><span class="n">σ</span><span class="p">,</span> <span class="n">hh</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="c1"># 计算总量</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">compute_aggregates</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">hh</span><span class="p">)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">D</span>

        <span class="c1"># 更新价格</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">KL_to_r</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">),</span> <span class="n">KL_to_w</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">firm</span><span class="p">)</span>

        <span class="c1"># 寻找τ</span>
        <span class="n">D_next</span> <span class="o">=</span> <span class="n">D</span>
        <span class="n">τ</span> <span class="o">=</span> <span class="n">find_τ</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="n">D_next</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>

        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">r_old</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">w_old</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">r_old</span><span class="p">,</span> <span class="n">w_old</span>

    <span class="c1"># 初始状态</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="n">num_state</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">σ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="n">num_state</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">μ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="n">num_state</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">K</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span>
                                    <span class="n">cond_fn</span><span class="p">,</span> <span class="n">body_fn</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">δ</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss1</span> <span class="o">=</span> <span class="n">find_ss</span><span class="p">(</span><span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">)],</span> <span class="n">Q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>让我们计时计算过程</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> find_ss(hh, firm, [0, 0.1, np.zeros(hh.j_grid.size)], Q)[0].block_until_ready();
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hh_out_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">quant_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">price_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">policy_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># V, σ, μ</span>
<span class="n">V_ss1</span><span class="p">,</span> <span class="n">σ_ss1</span><span class="p">,</span> <span class="n">μ_ss1</span> <span class="o">=</span> <span class="n">hh_out_ss1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># K, L</span>
<span class="n">K_ss1</span><span class="p">,</span> <span class="n">L_ss1</span> <span class="o">=</span> <span class="n">quant_ss1</span>

<span class="n">K_ss1</span><span class="p">,</span> <span class="n">L_ss1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 利率，工资</span>
<span class="n">r_ss1</span><span class="p">,</span> <span class="n">w_ss1</span> <span class="o">=</span> <span class="n">price_ss1</span>

<span class="n">r_ss1</span><span class="p">,</span> <span class="n">w_ss1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># τ, D, G, δ</span>
<span class="n">τ_ss1</span><span class="p">,</span> <span class="n">D_ss1</span><span class="p">,</span> <span class="n">G_ss1</span><span class="p">,</span> <span class="n">δ_ss1</span> <span class="o">=</span> <span class="n">policy_ss1</span>

<span class="n">τ_ss1</span><span class="p">,</span> <span class="n">D_ss1</span><span class="p">,</span> <span class="n">G_ss1</span><span class="p">,</span> <span class="n">δ_ss1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id23">
<h2><span class="section-number">75.12. </span>转换动态<a class="headerlink" href="#id23" title="Link to this heading">#</a></h2>
<p>我们使用<code class="docutils literal notranslate"><span class="pre">path_iteration</span></code>函数计算转换动态。</p>
<p>在外循环中，我们对价格和税收的猜测值进行迭代。</p>
<p>在内循环中，我们计算每个年龄组<span class="math notranslate nohighlight">\(j\)</span>在每个时间<span class="math notranslate nohighlight">\(t\)</span>的最优消费和储蓄选择，然后找出资产和生产力联合分布的隐含演变。</p>
<p>然后，我们根据经济中的总劳动供给和资本存量更新价格和税收的猜测值。</p>
<p>我们使用<code class="docutils literal notranslate"><span class="pre">solve_backwards</span></code>来求解给定价格和税收序列下的最优储蓄选择，并使用<code class="docutils literal notranslate"><span class="pre">simulate_forward</span></code>来计算联合分布的演变。</p>
<p>我们需要两个稳态作为输入：初始稳态为<code class="docutils literal notranslate"><span class="pre">simulate_forward</span></code>提供初始条件，最终稳态为<code class="docutils literal notranslate"><span class="pre">solve_backwards</span></code>提供延续值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bellman_operator</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">taxes</span><span class="p">,</span> <span class="n">V_next</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">r</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">prices</span>
    <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="n">taxes</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_action</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bellman_operator_j</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
        <span class="n">Rj</span> <span class="o">=</span> <span class="n">populate_R</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">household</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">Rj</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V_next</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">σ_j</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">V_j</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_state</span><span class="p">),</span> <span class="n">σ_j</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">V_j</span><span class="p">,</span> <span class="n">σ_j</span>

    <span class="n">V</span><span class="p">,</span> <span class="n">σ</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">bellman_operator_j</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># 最后的生命阶段</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">J</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">Rj</span> <span class="o">=</span> <span class="n">populate_R</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">household</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">Rj</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">VJ</span><span class="p">)</span>
    <span class="n">σ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">σ</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]])</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">V</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_state</span><span class="p">),</span> <span class="n">σ</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]])</span>

    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">σ</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_backwards</span><span class="p">(</span><span class="n">V_ss2</span><span class="p">,</span> <span class="n">σ_ss2</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">price_seq</span><span class="p">,</span> <span class="n">pol_seq</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">j_grid</span><span class="o">.</span><span class="n">size</span> 
    <span class="n">num_state</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="n">τ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span> <span class="o">=</span> <span class="n">pol_seq</span>
    <span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span> <span class="o">=</span> <span class="n">price_seq</span>

    <span class="n">T</span> <span class="o">=</span> <span class="n">r_seq</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_backwards_t</span><span class="p">(</span><span class="n">V_next</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>

        <span class="n">prices</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">taxes</span> <span class="o">=</span> <span class="p">(</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> 
        <span class="n">V</span><span class="p">,</span> <span class="n">σ</span> <span class="o">=</span> <span class="n">bellman_operator</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">taxes</span><span class="p">,</span> <span class="n">V_next</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">σ</span><span class="p">)</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">init_V</span> <span class="o">=</span> <span class="n">V_ss2</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">solve_backwards_t</span><span class="p">,</span> <span class="n">init_V</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
    <span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span> <span class="o">=</span> <span class="n">outputs</span>
    <span class="n">V_seq</span> <span class="o">=</span> <span class="n">V_seq</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">σ_seq</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">V_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">V_seq</span><span class="p">,</span> <span class="n">V_ss2</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]])</span>
    <span class="n">σ_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">σ_seq</span><span class="p">,</span> <span class="n">σ_ss2</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]])</span>

    <span class="k">return</span> <span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">population_evolution</span><span class="p">(</span><span class="n">σt</span><span class="p">,</span> <span class="n">μt</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">J</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">num_state</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">population_evolution_j</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>

        <span class="n">Qσ</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_state</span><span class="p">),</span> <span class="n">σt</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
        <span class="n">μ_next</span> <span class="o">=</span> <span class="n">μt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">@</span> <span class="n">Qσ</span>

        <span class="k">return</span> <span class="n">μ_next</span>

    <span class="n">μ_next</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">population_evolution_j</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">μ_next</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">init_μ</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">μ_next</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">μ_next</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_forwards</span><span class="p">(</span><span class="n">σ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">μ_ss1</span><span class="p">,</span> <span class="n">K_ss1</span><span class="p">,</span> <span class="n">L_ss1</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>

    <span class="n">j_grid</span><span class="p">,</span> <span class="n">a_grid</span><span class="p">,</span> <span class="n">γ_grid</span><span class="p">,</span> <span class="n">Π</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">VJ</span> <span class="o">=</span> <span class="n">household</span>

    <span class="n">J</span><span class="p">,</span> <span class="n">num_state</span> <span class="o">=</span> <span class="n">μ_ss1</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">T</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_forwards_t</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>

        <span class="n">μ_next</span> <span class="o">=</span> <span class="n">population_evolution</span><span class="p">(</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">μ</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="n">A</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">compute_aggregates</span><span class="p">(</span><span class="n">μ_next</span><span class="p">,</span> <span class="n">household</span><span class="p">)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">D_seq</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">μ_next</span><span class="p">,</span> <span class="p">(</span><span class="n">μ_next</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">init_μ</span> <span class="o">=</span> <span class="n">μ_ss1</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">simulate_forwards_t</span><span class="p">,</span> <span class="n">init_μ</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
    <span class="n">μ_seq</span><span class="p">,</span> <span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span> <span class="o">=</span> <span class="n">outputs</span>

    <span class="n">μ_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">μ_ss1</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">μ_seq</span><span class="p">])</span>
    <span class="n">K_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">K_ss1</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">K_seq</span><span class="p">])</span>
    <span class="n">L_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">L_ss1</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">L_seq</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">μ_seq</span><span class="p">,</span> <span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span>
</pre></div>
</div>
</div>
</div>
<p>以下算法描述了路径迭代程序：</p>
<div class="proof algorithm admonition" id="ak-aiyagari-algorithm">
<p class="admonition-title"><span class="caption-number">算法 75.1 </span> (AK-Aiyagari过渡路径算法)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>输入</strong> 给定初始稳态<span class="math notranslate nohighlight">\(ss_1\)</span>，最终稳态<span class="math notranslate nohighlight">\(ss_2\)</span>，时间范围<span class="math notranslate nohighlight">\(T\)</span>，和政策序列<span class="math notranslate nohighlight">\((D, G, \delta)\)</span></p>
<p><strong>输出</strong> 计算价值函数<span class="math notranslate nohighlight">\(V\)</span>、政策函数<span class="math notranslate nohighlight">\(\sigma\)</span>、分布<span class="math notranslate nohighlight">\(\mu\)</span>和价格<span class="math notranslate nohighlight">\((r, w, \tau)\)</span>的均衡过渡路径</p>
<ol class="arabic simple">
<li><p>从稳态初始化：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((V_1, \sigma_1, \mu_1) \leftarrow ss_1\)</span> <em>(初始稳态)</em></p></li>
<li><p><span class="math notranslate nohighlight">\((V_2, \sigma_2, \mu_2) \leftarrow ss_2\)</span> <em>(最终稳态)</em></p></li>
<li><p><span class="math notranslate nohighlight">\((r, w, \tau) \leftarrow initialize\_prices(T)\)</span> <em>(线性插值)</em></p></li>
<li><p><span class="math notranslate nohighlight">\(error \leftarrow \infty\)</span>, <span class="math notranslate nohighlight">\(i \leftarrow 0\)</span></p></li>
</ul>
</li>
<li><p><strong>当</strong> <span class="math notranslate nohighlight">\(error &gt; \varepsilon\)</span> 或 <span class="math notranslate nohighlight">\(i \leq max\_iter\)</span> 时：</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(i \leftarrow i + 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((r_{\text{old}}, w_{\text{old}}, \tau_{\text{old}}) \leftarrow (r, w, \tau)\)</span></p></li>
<li><p><strong>向后归纳：</strong> 对于 <span class="math notranslate nohighlight">\(t \in [T, 1]\)</span>：</p>
<ul class="simple">
<li><p>对于 <span class="math notranslate nohighlight">\(j \in [0, J-1]\)</span> <em>(年龄组)</em>：</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(V[t,j] \leftarrow \max_{a'} \{u(c) + \beta\mathbb{E}[V[t+1,j+1]]\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma[t,j] \leftarrow \arg\max_{a'} \{u(c) + \beta\mathbb{E}[V[t+1,j+1]]\}\)</span></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>向前模拟：</strong> 对于 <span class="math notranslate nohighlight">\(t \in [1, T]\)</span>：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu[t] \leftarrow \Gamma(\sigma[t], \mu[t-1])\)</span> <em>(分布演化)</em></p></li>
<li><p><span class="math notranslate nohighlight">\(K[t] \leftarrow \int a \, d\mu[t] - D[t]\)</span> <em>(总资本)</em></p></li>
<li><p><span class="math notranslate nohighlight">\(L[t] \leftarrow \int l(j)\gamma \, d\mu[t]\)</span> <em>(总劳动)</em></p></li>
</ul>
</li>
</ol>
</li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r[t] \leftarrow \alpha Z(K[t]/L[t])^{\alpha-1}\)</span> <em>(利率)</em>
- <span class="math notranslate nohighlight">\(w[t] \leftarrow (1-\alpha)Z(K[t]/L[t])^{\alpha}\)</span> <em>(工资率)</em>
- <span class="math notranslate nohighlight">\(\tau[t] \leftarrow solve\_budget(r[t],w[t],K[t],L[t],D[t],G[t])\)</span></p>
<ol class="arabic simple" start="5">
<li><p>计算收敛指标：</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(error \leftarrow \|r - r_{\text{old}}\| + \|w - w_{\text{old}}\| + \|\tau - \tau_{\text{old}}\|\)</span></p></li>
</ul>
</li>
<li><p>使用阻尼更新价格：</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(r \leftarrow \lambda r + (1-\lambda)r_{\text{old}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(w \leftarrow \lambda w + (1-\lambda)w_{\text{old}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\tau \leftarrow \lambda \tau + (1-\lambda)\tau_{\text{old}}\)</span></p></li>
</ul>
</li>
</ol>
</li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>返回</strong> <span class="math notranslate nohighlight">\((V, \sigma, \mu, r, w, \tau)\)</span></p></li>
</ol>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">path_iteration</span><span class="p">(</span><span class="n">ss1</span><span class="p">,</span> <span class="n">ss2</span><span class="p">,</span> <span class="n">pol_target</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="c1"># 起点：初始稳态</span>
    <span class="n">V_ss1</span><span class="p">,</span> <span class="n">σ_ss1</span><span class="p">,</span> <span class="n">μ_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">K_ss1</span><span class="p">,</span> <span class="n">L_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_ss1</span><span class="p">,</span> <span class="n">w_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">τ_ss1</span><span class="p">,</span> <span class="n">D_ss1</span><span class="p">,</span> <span class="n">G_ss1</span><span class="p">,</span> <span class="n">δ_ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>

    <span class="c1"># 终点：收敛的新稳态</span>
    <span class="n">V_ss2</span><span class="p">,</span> <span class="n">σ_ss2</span><span class="p">,</span> <span class="n">μ_ss2</span> <span class="o">=</span> <span class="n">ss2</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">K_ss2</span><span class="p">,</span> <span class="n">L_ss2</span> <span class="o">=</span> <span class="n">ss2</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_ss2</span><span class="p">,</span> <span class="n">w_ss2</span> <span class="o">=</span> <span class="n">ss2</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">τ_ss2</span><span class="p">,</span> <span class="n">D_ss2</span><span class="p">,</span> <span class="n">G_ss2</span><span class="p">,</span> <span class="n">δ_ss2</span> <span class="o">=</span> <span class="n">ss2</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>

    <span class="c1"># 给定的政策：D, G, δ</span>
    <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span> <span class="o">=</span> <span class="n">pol_target</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">G_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># 价格的初始猜测</span>
    <span class="n">r_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_ss2</span> <span class="o">-</span> <span class="n">r_ss1</span><span class="p">)</span> <span class="o">+</span> <span class="n">r_ss1</span>
    <span class="n">w_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">w_ss2</span> <span class="o">-</span> <span class="n">w_ss1</span><span class="p">)</span> <span class="o">+</span> <span class="n">w_ss1</span>

    <span class="c1"># 政策的初始猜测</span>
    <span class="n">τ_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">τ_ss2</span> <span class="o">-</span> <span class="n">τ_ss1</span><span class="p">)</span> <span class="o">+</span> <span class="n">τ_ss1</span>

    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_iter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">r_seq</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">w_seq</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">τ_seq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;iter </span><span class="si">{</span><span class="n">num_iter</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="c1"># 重复直到找到不动点</span>

        <span class="n">r_old</span><span class="p">,</span> <span class="n">w_old</span><span class="p">,</span> <span class="n">τ_old</span> <span class="o">=</span> <span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span><span class="p">,</span> <span class="n">τ_seq</span>

        <span class="n">pol_seq</span> <span class="o">=</span> <span class="p">(</span><span class="n">τ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span><span class="p">)</span>
        <span class="n">price_seq</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span><span class="p">)</span>

        <span class="c1"># 向后求解最优政策</span>
        <span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span> <span class="o">=</span> <span class="n">solve_backwards</span><span class="p">(</span>
            <span class="n">V_ss2</span><span class="p">,</span> <span class="n">σ_ss2</span><span class="p">,</span> <span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">price_seq</span><span class="p">,</span> <span class="n">pol_seq</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="c1"># 向前计算人口演变</span>
        <span class="n">μ_seq</span><span class="p">,</span> <span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span> <span class="o">=</span> <span class="n">simulate_forwards</span><span class="p">(</span>
            <span class="n">σ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">μ_ss1</span><span class="p">,</span> <span class="n">K_ss1</span><span class="p">,</span> <span class="n">L_ss1</span><span class="p">,</span> <span class="n">household</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

        <span class="c1"># 根据总资本和劳动供给更新价格</span>
        <span class="n">r_seq</span> <span class="o">=</span> <span class="n">KL_to_r</span><span class="p">(</span><span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span><span class="p">,</span> <span class="n">firm</span><span class="p">)</span>
        <span class="n">w_seq</span> <span class="o">=</span> <span class="n">KL_to_w</span><span class="p">(</span><span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span><span class="p">,</span> <span class="n">firm</span><span class="p">)</span>

        <span class="c1"># 找到平衡政府预算约束的税率</span>
        <span class="n">τ_seq</span> <span class="o">=</span> <span class="n">find_τ</span><span class="p">([</span><span class="n">D_seq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">D_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span><span class="p">],</span>
                       <span class="p">[</span><span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span><span class="p">],</span>
                       <span class="p">[</span><span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span><span class="p">])</span>

        <span class="c1"># 新旧猜测之间的距离</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">r_old</span> <span class="o">-</span> <span class="n">r_seq</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">w_old</span> <span class="o">-</span> <span class="n">w_seq</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">τ_old</span> <span class="o">-</span> <span class="n">τ_seq</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">num_iter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;迭代 </span><span class="si">{</span><span class="n">num_iter</span><span class="si">:</span><span class="s2">3d</span><span class="si">}</span><span class="s2">: error = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.6e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">r_seq</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">w_seq</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">τ_seq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;iter </span><span class="si">{</span><span class="n">num_iter</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">r_seq</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_seq</span> <span class="o">+</span> <span class="n">r_old</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">w_seq</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_seq</span> <span class="o">+</span> <span class="n">w_old</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">τ_seq</span> <span class="o">=</span> <span class="p">(</span><span class="n">τ_seq</span> <span class="o">+</span> <span class="n">τ_old</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;τ&#39;</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span><span class="p">,</span> <span class="n">μ_seq</span><span class="p">,</span> <span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span><span class="p">,</span> <span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span><span class="p">,</span> \
            <span class="n">τ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span>
</pre></div>
</div>
</div>
</div>
<p>现在我们可以计算由财政政策改革引发的均衡转换。</p>
</section>
<section id="id24">
<h2><span class="section-number">75.13. </span>实验1：即时减税<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<p>假设政府降低税率，并通过发行债务立即平衡其预算。</p>
<p>在<span class="math notranslate nohighlight">\(t=0\)</span>时，政府出人意料地宣布立即减税。</p>
<p>从<span class="math notranslate nohighlight">\(t=0\)</span>到<span class="math notranslate nohighlight">\(19\)</span>，政府发行债务，因此债务<span class="math notranslate nohighlight">\(D_{t+1}\)</span>在20个周期内呈线性增长。</p>
<p>政府为其新债务水平设定目标<span class="math notranslate nohighlight">\(D_{20} =D_0 + 1 = \bar{D} + 1\)</span>。</p>
<p>政府支出<span class="math notranslate nohighlight">\(\bar{G}\)</span>和转移支付<span class="math notranslate nohighlight">\(\bar{\delta}_j\)</span>保持不变。</p>
<p>政府调整<span class="math notranslate nohighlight">\(\tau_t\)</span>以在转换过程中平衡预算。</p>
<p>我们要计算均衡转换路径。</p>
<p>我们的第一步是准备适当的政策变量数组<code class="docutils literal notranslate"><span class="pre">D_seq</span></code>、<code class="docutils literal notranslate"><span class="pre">G_seq</span></code>、<code class="docutils literal notranslate"><span class="pre">δ_seq</span></code></p>
<p>我们将计算一个能平衡政府预算的<code class="docutils literal notranslate"><span class="pre">τ_seq</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">D_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">D_ss1</span>
<span class="n">D_seq</span> <span class="o">=</span> <span class="n">D_seq</span><span class="o">.</span><span class="n">at</span><span class="p">[:</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">D_ss1</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">D_seq</span> <span class="o">=</span> <span class="n">D_seq</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">21</span><span class="p">:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">D_seq</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>

<span class="n">G_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">G_ss1</span>

<span class="n">δ_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">δ_ss1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">δ_ss1</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>为了迭代路径，我们首先需要找到其目标点，也就是在新财政政策下的新稳态。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss2</span> <span class="o">=</span> <span class="n">find_ss</span><span class="p">(</span><span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="p">[</span><span class="n">D_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">G_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">δ_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>我们可以使用<code class="docutils literal notranslate"><span class="pre">path_iteration</span></code>来寻找均衡转移动态。</p>
<p>通过设置关键参数<code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>，可以让函数<code class="docutils literal notranslate"><span class="pre">path_iteration</span></code>显示收敛信息。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paths</span> <span class="o">=</span> <span class="n">path_iteration</span><span class="p">(</span><span class="n">ss1</span><span class="p">,</span> <span class="n">ss2</span><span class="p">,</span> <span class="p">[</span><span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span><span class="p">],</span> <span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>在成功计算了转型动态后，让我们来研究它们。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span><span class="p">,</span> <span class="n">μ_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">τ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="p">,</span> <span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lj</span> <span class="o">=</span> <span class="n">l</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">γ</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
<span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> \
        <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
<span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

<span class="n">c_mean0</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>我们关注政策变化如何影响不同年龄群体和不同时期的消费。</p>
<p>我们可以研究特定年龄的平均消费水平。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">149</span><span class="p">]:</span>

    <span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="n">c_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">c_mean</span><span class="o">-</span><span class="n">c_mean0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta mean(C(j))$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>为了总结这个转变过程，我们可以像在<a class="reference internal" href="ak2.html"><span class="doc">代际交叠模型中的转型</span></a>中那样绘制路径。</p>
<p>但与那个两期生命的世代交叠模型设置不同，我们现在不再有具有代表性的老年和年轻主体。</p>
<ul class="simple">
<li><p>现在我们在每个时间点都有50个不同年龄的群组</p></li>
</ul>
<p>为了继续，我们构建两个规模相等的年龄组 – 年轻组和老年组。</p>
<ul class="simple">
<li><p>在25岁时，一个人从年轻组转变为老年组</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_ss1</span><span class="p">]</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span>
<span class="n">δ</span> <span class="o">=</span> <span class="n">δ_ss1</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_ss1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_ss1</span><span class="p">))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_ss1</span><span class="p">)</span> <span class="o">*</span> <span class="n">w_ss1</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
<span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

<span class="n">Cy_ss1</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">μ_ss1</span><span class="p">[:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Co_ss1</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">*</span> <span class="n">μ_ss1</span><span class="p">[</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">Cy_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">Co_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="n">Cy_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">Co_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Cy (j=0-24)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cy_seq</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">Cy_ss1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cy (j &lt; 25)&#39;</span><span class="p">)</span>

<span class="c1"># Cy (j=25-49)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Co_seq</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">Co_ss1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Co (j $\geq$ 25)&#39;</span><span class="p">)</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;τ&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)):</span>
    <span class="n">i_var</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span>
    <span class="n">i_axes</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="n">row_i</span> <span class="o">=</span> <span class="n">i_axes</span> <span class="o">//</span> <span class="mi">3</span>
    <span class="n">col_i</span> <span class="o">=</span> <span class="n">i_axes</span> <span class="o">%</span> <span class="mi">3</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i_var</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">ss1</span><span class="p">[</span><span class="n">i_var</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># y轴范围</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ss1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ss1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>现在让我们计算每个时间点<span class="math notranslate nohighlight">\(t\)</span>下基于年龄的条件消费均值和方差。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cmean_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">J</span><span class="p">))</span>
<span class="n">Cvar_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">J</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="n">Cmean_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Cvar_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">Cmean_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J_seq</span><span class="p">,</span> <span class="n">T_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

<span class="c1"># 绘制消费均值随年龄和时间的变化</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">T_range</span><span class="p">,</span> <span class="n">J_seq</span><span class="p">,</span> <span class="n">Cmean_seq</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;消费均值&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;j&quot;</span><span class="p">)</span>

<span class="c1"># 绘制消费方差随年龄和时间的变化</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">T_range</span><span class="p">,</span> <span class="n">J_seq</span><span class="p">,</span> <span class="n">Cvar_seq</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;消费方差&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;j&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id25">
<h2><span class="section-number">75.14. </span>实验2：预先宣布的减税<a class="headerlink" href="#id25" title="Link to this heading">#</a></h2>
<p>现在政府在时间<span class="math notranslate nohighlight">\(0\)</span>宣布永久性减税，但在20个周期后才实施。</p>
<p>我们将使用相同的关键工具<code class="docutils literal notranslate"><span class="pre">path_iteration</span></code>。</p>
<p>我们必须适当地指定<code class="docutils literal notranslate"><span class="pre">D_seq</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">D_t</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">D_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">D_ss1</span>
<span class="n">D_seq</span> <span class="o">=</span> <span class="n">D_seq</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">D_t</span><span class="p">:</span><span class="n">D_t</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">D_ss1</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">D_seq</span> <span class="o">=</span> <span class="n">D_seq</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">D_t</span><span class="o">+</span><span class="mi">21</span><span class="p">:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">D_seq</span><span class="p">[</span><span class="n">D_t</span><span class="o">+</span><span class="mi">20</span><span class="p">])</span>

<span class="n">G_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">G_ss1</span>

<span class="n">δ_seq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">δ_ss1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">δ_ss1</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss2</span> <span class="o">=</span> <span class="n">find_ss</span><span class="p">(</span><span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="p">[</span><span class="n">D_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">G_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">δ_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paths</span> <span class="o">=</span> <span class="n">path_iteration</span><span class="p">(</span><span class="n">ss1</span><span class="p">,</span> <span class="n">ss2</span><span class="p">,</span> <span class="p">[</span><span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span><span class="p">],</span> 
                    <span class="n">hh</span><span class="p">,</span> <span class="n">firm</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_seq</span><span class="p">,</span> <span class="n">σ_seq</span><span class="p">,</span> <span class="n">μ_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">K_seq</span><span class="p">,</span> <span class="n">L_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r_seq</span><span class="p">,</span> <span class="n">w_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">τ_seq</span><span class="p">,</span> <span class="n">D_seq</span><span class="p">,</span> <span class="n">G_seq</span><span class="p">,</span> <span class="n">δ_seq</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">σ_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">Cy_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">Co_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="n">Cy_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">Co_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">J</span><span class="o">//</span><span class="mi">2</span><span class="p">:])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>下面我们绘制经济的转换路径。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Cy (j=0-24)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cy_seq</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">Cy_ss1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cy (j &lt; 25)&#39;</span><span class="p">)</span>

<span class="c1"># Cy (j=25-49)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Co_seq</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">Co_ss1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Co (j $\geq$ 25)&#39;</span><span class="p">)</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;τ&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)):</span>
    <span class="n">i_var</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span>
    <span class="n">i_axes</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="n">row_i</span> <span class="o">=</span> <span class="n">i_axes</span> <span class="o">//</span> <span class="mi">3</span>
    <span class="n">col_i</span> <span class="o">=</span> <span class="n">i_axes</span> <span class="o">%</span> <span class="mi">3</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i_var</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">ss1</span><span class="p">[</span><span class="n">i_var</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_i</span><span class="p">,</span> <span class="n">col_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># ylims</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ss1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ss1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ss1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>注意价格和数量是如何立即对预期的税率上调作出反应的。</p>
<p>让我们仔细观察资本存量是如何反应的。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># K</span>
<span class="n">i_var</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i_var</span><span class="p">][:</span><span class="mi">25</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">ss1</span><span class="p">[</span><span class="n">i_var</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">6.56</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;tax cut&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">6.52</span><span class="p">,</span> <span class="mf">6.65</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>在t=20实施减税政策后，由于挤出效应，总资本将会减少。</p>
<p>个人在t=20之前几个时期就已预见到利率将会上升，因此开始增加储蓄。</p>
<p>由于储蓄的增加导致资本增加，随之而来的是利率的暂时下降。</p>
<p>对于生活在更早时期的个体来说，这种较低的利率使他们减少储蓄。</p>
<p>我们还可以沿着转换路径绘制不同群体消费的均值和方差的演变。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cmean_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">J</span><span class="p">))</span>
<span class="n">Cvar_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">J</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="p">[</span><span class="n">σ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="n">δ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">inc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">r_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">τ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="n">w_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">lj</span> <span class="o">*</span> <span class="n">γ</span> <span class="o">-</span> <span class="n">δ</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">hh</span><span class="o">.</span><span class="n">j_grid</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">hh</span><span class="o">.</span><span class="n">a_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">hh</span><span class="o">.</span><span class="n">γ_grid</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">inc</span> <span class="o">-</span> <span class="n">ap</span>

    <span class="n">Cmean_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Cvar_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">Cmean_seq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">μ_seq</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J_seq</span><span class="p">,</span> <span class="n">T_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">J</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

<span class="c1"># 绘制消费均值随年龄和时间的变化</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">T_range</span><span class="p">,</span> <span class="n">J_seq</span><span class="p">,</span> <span class="n">Cmean_seq</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;消费均值&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;j&quot;</span><span class="p">)</span>

<span class="c1"># 绘制消费方差随年龄和时间的变化</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">T_range</span><span class="p">,</span> <span class="n">J_seq</span><span class="p">,</span> <span class="n">Cvar_seq</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;消费方差&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;j&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  基础工具
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. 新冠病毒建模
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. 线性代数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR分解
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. 循环矩阵
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. 奇异值分解
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. 向量自回归和动态模态分解
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. 使用牛顿法求解经济模型
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  基础统计学
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. 基础概率论与矩阵
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. 一些概率分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. 大数定律 和 中心极限定理
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. 概率的两种含义
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. 多元超几何分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. 多元正态分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. 故障树不确定性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. 人工神经网络简介
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. 随机化回应调查
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. 随机回答的期望效用
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  贝叶斯定律
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. 非共轭先验
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. AR(1)参数的后验分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. 预测 AR(1) 过程
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  统计与信息论
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. 统计散度度量
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. 似然比过程
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process_2.html">
   23. 异质信念与金融市场
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. VAR模型的似然过程
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. 似然比过程的均值
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. 让弥尔顿·弗里德曼困惑的问题
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. 用贝叶斯方法解决弗里德曼和瓦尔德问题
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. 可交换性和贝叶斯更新
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. 似然比过程和贝叶斯学习
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. 错误模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. 贝叶斯与频率主义决策规则的比较
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  线性规划
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. 最优传输
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. 冯·诺依曼增长模型（及其推广）
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  动态系统导论
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. 有限马尔可夫链
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. 库存动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. 线性状态空间模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   37. 萨缪尔森乘数-加速器模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kesten过程与企业动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. 财富分布动态
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. 初见卡尔曼滤波器
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. 卡尔曼滤波器进阶
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  搜索
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. 工作搜寻 I: McCall搜寻模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. 工作搜寻 II：搜寻与离职
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   44. 工作搜寻 III: 拟合值函数迭代
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   45. 工作搜寻 IV：相关工资报价
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   46. 工作搜寻 V：职业选择建模
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   47. 工作搜寻 VI：在职搜索
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   48. 工作搜寻 VII：McCall劳动者的Q学习
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. 工作搜寻 VII: 带学习的搜索
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  消费、储蓄与资本
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   50. Cass-Koopmans模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   51. Cass-Koopmans竞争均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   52. 带扭曲性税收的Cass-Koopmans模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   53. 带扭曲性税收的双国模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   54. 代际交叠模型中的转型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   55. 吃蛋糕问题 I：最优储蓄导论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   56. 吃蛋糕问题 II：数值方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   57. 最优增长 I：随机最优增长模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   58. 最优增长 II：使用Numba加速代码
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   59. 最优增长 III：时间迭代
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   60. 最优增长 IV：内生网格法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   61. 收入波动问题 I：基本模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   62. 收入波动问题 II：资产随机收益
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ控制
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   63. LQ控制：基础
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   64. LQ控制的拉格朗日方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   65. 消除交叉项
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   66. 永久收入模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   67. 永久收入 II：线性二次方法
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   68. 通过库存实现生产平滑
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  多主体模型
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   69. 就业与失业的湖泊模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   70. 理性预期均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   71. 线性理性预期模型中的稳定性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   72. 马尔可夫完美均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   73. 不确定性陷阱
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   74. 艾亚加里模型
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   75. 长寿、异质性个体、世代交叠模型
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  资产定价与金融
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   76. 资产定价：有限状态模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   77. 带有阿罗证券的竞争均衡
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   78. 异质信念与泡沫
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  数据与实证
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   79. 用Pandas处理面板数据
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   80. Python线性回归
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   81. 最大似然估计
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  拍卖
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   82. 一价和二价拍卖
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   83. 多种商品分配机制
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  其他
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   84. 故障排除
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   85. 参考文献
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   86. 执行统计
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/ak_aiyagari.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/ak_aiyagari.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/ak_aiyagari.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.zh-cn.notebooks" data-urlpath="tree/lecture-python.zh-cn.notebooks/ak_aiyagari.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.zh-cn.notebooks/blob/main/ak_aiyagari.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "ak_aiyagari";
                const repoURL = "https://github.com/QuantEcon/lecture-python.zh-cn.notebooks";
                const urlPath = "tree/lecture-python.zh-cn.notebooks/ak_aiyagari.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>